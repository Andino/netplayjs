!function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(o,i,function(t){return e[t]}.bind(null,i));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=44)}([function(e,t,n){e.exports=n(2)},function(e,t){
/*!
 * Chai - flag utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
e.exports=function(e,t,n){var o=e.__flags||(e.__flags=Object.create(null));if(3!==arguments.length)return o[t];o[t]=n}},function(e,t,n){
/*!
 * chai
 * Copyright(c) 2011-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
var o=[];
/*!
 * Chai version
 */t.version="4.2.0",
/*!
 * Assertion Error
 */
t.AssertionError=n(10);
/*!
 * Utils for plugins (not exported)
 */
var i=n(18);t.use=function(e){return~o.indexOf(e)||(e(t,i),o.push(e)),t},
/*!
 * Utility Functions
 */
t.util=i;
/*!
 * Configuration
 */
var r=n(4);t.config=r;
/*!
 * Primary `Assertion` prototype
 */
var s=n(36);t.use(s);
/*!
 * Core Assertions
 */
var a=n(37);t.use(a);
/*!
 * Expect interface
 */
var c=n(38);t.use(c);
/*!
 * Should interface
 */
var u=n(39);t.use(u);
/*!
 * Assert interface
 */
var l=n(40);t.use(l)},function(e,t){
/*!
 * Chai - transferFlags utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
e.exports=function(e,t,n){var o=e.__flags||(e.__flags=Object.create(null));for(var i in t.__flags||(t.__flags=Object.create(null)),n=3!==arguments.length||n,o)(n||"object"!==i&&"ssfi"!==i&&"lockSsfi"!==i&&"message"!=i)&&(t.__flags[i]=o[i])}},function(e,t){e.exports={includeStack:!1,showDiff:!0,truncateThreshold:40,useProxy:!0,proxyExcludedKeys:["then","catch","inspect","toJSON"]}},function(e,t,n){var o=n(4);
/*!
 * Chai - isProxyEnabled helper
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */e.exports=function(){return o.useProxy&&"undefined"!=typeof Proxy&&"undefined"!=typeof Reflect}},function(e,t){var n=Object.getOwnPropertyDescriptor(function(){},"length");
/*!
 * Chai - addLengthGuard utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */e.exports=function(e,t,o){return n.configurable?(Object.defineProperty(e,"length",{get:function(){if(o)throw Error("Invalid Chai property: "+t+'.length. Due to a compatibility issue, "length" cannot directly follow "'+t+'". Use "'+t+'.lengthOf" instead.');throw Error("Invalid Chai property: "+t+'.length. See docs for proper usage of "'+t+'".')}}),e):e}},function(e,t,n){var o=n(4),i=n(1),r=n(14),s=n(5),a=["__flags","__methods","_obj","assert"];e.exports=function(e,t){return s()?new Proxy(e,{get:function e(n,s){if("string"==typeof s&&-1===o.proxyExcludedKeys.indexOf(s)&&!Reflect.has(n,s)){if(t)throw Error("Invalid Chai property: "+t+"."+s+'. See docs for proper usage of "'+t+'".');var c=null,u=4;throw r(n).forEach(function(e){if(!Object.prototype.hasOwnProperty(e)&&-1===a.indexOf(e)){var t=function(e,t,n){if(Math.abs(e.length-t.length)>=n)return n;for(var o=[],i=0;i<=e.length;i++)o[i]=Array(t.length+1).fill(0),o[i][0]=i;for(var r=0;r<t.length;r++)o[0][r]=r;for(var i=1;i<=e.length;i++)for(var s=e.charCodeAt(i-1),r=1;r<=t.length;r++)Math.abs(i-r)>=n?o[i][r]=n:o[i][r]=Math.min(o[i-1][r]+1,o[i][r-1]+1,o[i-1][r-1]+(s===t.charCodeAt(r-1)?0:1));return o[e.length][t.length]}(s,e,u);t<u&&(c=e,u=t)}}),null!==c?Error("Invalid Chai property: "+s+'. Did you mean "'+c+'"?'):Error("Invalid Chai property: "+s)}return-1!==a.indexOf(s)||i(n,"lockSsfi")||i(n,"ssfi",e),Reflect.get(n,s)}}):e}},function(e,t,n){(function(t){var n;n=function(){"use strict";var e="function"==typeof Promise,n="object"==typeof self?self:t,o="undefined"!=typeof Symbol,i="undefined"!=typeof Map,r="undefined"!=typeof Set,s="undefined"!=typeof WeakMap,a="undefined"!=typeof WeakSet,c="undefined"!=typeof DataView,u=o&&void 0!==Symbol.iterator,l=o&&void 0!==Symbol.toStringTag,h=r&&"function"==typeof Set.prototype.entries,p=i&&"function"==typeof Map.prototype.entries,f=h&&Object.getPrototypeOf((new Set).entries()),d=p&&Object.getPrototypeOf((new Map).entries()),y=u&&"function"==typeof Array.prototype[Symbol.iterator],g=y&&Object.getPrototypeOf([][Symbol.iterator]()),b=u&&"function"==typeof String.prototype[Symbol.iterator],v=b&&Object.getPrototypeOf(""[Symbol.iterator]()),m=8,w=-1;return function(t){var o=typeof t;if("object"!==o)return o;if(null===t)return"null";if(t===n)return"global";if(Array.isArray(t)&&(!1===l||!(Symbol.toStringTag in t)))return"Array";if("object"==typeof window&&null!==window){if("object"==typeof window.location&&t===window.location)return"Location";if("object"==typeof window.document&&t===window.document)return"Document";if("object"==typeof window.navigator){if("object"==typeof window.navigator.mimeTypes&&t===window.navigator.mimeTypes)return"MimeTypeArray";if("object"==typeof window.navigator.plugins&&t===window.navigator.plugins)return"PluginArray"}if(("function"==typeof window.HTMLElement||"object"==typeof window.HTMLElement)&&t instanceof window.HTMLElement){if("BLOCKQUOTE"===t.tagName)return"HTMLQuoteElement";if("TD"===t.tagName)return"HTMLTableDataCellElement";if("TH"===t.tagName)return"HTMLTableHeaderCellElement"}}var u=l&&t[Symbol.toStringTag];if("string"==typeof u)return u;var h=Object.getPrototypeOf(t);return h===RegExp.prototype?"RegExp":h===Date.prototype?"Date":e&&h===Promise.prototype?"Promise":r&&h===Set.prototype?"Set":i&&h===Map.prototype?"Map":a&&h===WeakSet.prototype?"WeakSet":s&&h===WeakMap.prototype?"WeakMap":c&&h===DataView.prototype?"DataView":i&&h===d?"Map Iterator":r&&h===f?"Set Iterator":y&&h===g?"Array Iterator":b&&h===v?"String Iterator":null===h?"Object":Object.prototype.toString.call(t).slice(m,w)}},e.exports=n()}).call(this,n(21))},function(e,t,n){var o=n(13),i=n(14),r=n(24),s=n(4);e.exports=function(e,t,n,o){return c({showHidden:t,seen:[],stylize:function(e){return e}},e,void 0===n?2:n)};var a=function(e){return"object"==typeof HTMLElement?e instanceof HTMLElement:e&&"object"==typeof e&&"nodeType"in e&&1===e.nodeType&&"string"==typeof e.nodeName};function c(e,n,y){if(n&&"function"==typeof n.inspect&&n.inspect!==t.inspect&&(!n.constructor||n.constructor.prototype!==n)){var g=n.inspect(y,e);return"string"!=typeof g&&(g=c(e,g,y)),g}var b=function(e,t){switch(typeof t){case"undefined":return e.stylize("undefined","undefined");case"string":var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string");case"number":return 0===t&&1/t==-1/0?e.stylize("-0","number"):e.stylize(""+t,"number");case"boolean":return e.stylize(""+t,"boolean");case"symbol":return e.stylize(t.toString(),"symbol")}if(null===t)return e.stylize("null","null")}(e,n);if(b)return b;if(a(n)){if("outerHTML"in n)return n.outerHTML;try{if(document.xmlVersion)return(new XMLSerializer).serializeToString(n);var v=document.createElementNS("http://www.w3.org/1999/xhtml","_");v.appendChild(n.cloneNode(!1));var m=v.innerHTML.replace("><",">"+n.innerHTML+"<");return v.innerHTML="",m}catch(e){}}var w,_,k=r(n),x=e.showHidden?i(n):k;if(0===x.length||f(n)&&(1===x.length&&"stack"===x[0]||2===x.length&&"description"===x[0]&&"stack"===x[1])){if("function"==typeof n)return _=(w=o(n))?": "+w:"",e.stylize("[Function"+_+"]","special");if(h(n))return e.stylize(RegExp.prototype.toString.call(n),"regexp");if(p(n))return e.stylize(Date.prototype.toUTCString.call(n),"date");if(f(n))return u(n)}var S,O,M="",P=!1,C=!1,E=["{","}"];if("object"==typeof(S=n)&&/\w+Array]$/.test(d(S))&&(C=!0,E=["[","]"]),function(e){return Array.isArray(e)||"object"==typeof e&&"[object Array]"===d(e)}(n)&&(P=!0,E=["[","]"]),"function"==typeof n&&(M=" [Function"+(_=(w=o(n))?": "+w:"")+"]"),h(n)&&(M=" "+RegExp.prototype.toString.call(n)),p(n)&&(M=" "+Date.prototype.toUTCString.call(n)),f(n))return u(n);if(0===x.length&&(!P||0==n.length))return E[0]+M+E[1];if(y<0)return h(n)?e.stylize(RegExp.prototype.toString.call(n),"regexp"):e.stylize("[Object]","special");if(e.seen.push(n),P)O=function(e,t,n,o,i){for(var r=[],s=0,a=t.length;s<a;++s)Object.prototype.hasOwnProperty.call(t,String(s))?r.push(l(e,t,n,o,String(s),!0)):r.push("");return i.forEach(function(i){i.match(/^\d+$/)||r.push(l(e,t,n,o,i,!0))}),r}(e,n,y,k,x);else{if(C)return function(e){for(var t="[ ",n=0;n<e.length;++n){if(t.length>=s.truncateThreshold-7){t+="...";break}t+=e[n]+", "}-1!==(t+=" ]").indexOf(",  ]")&&(t=t.replace(",  ]"," ]"));return t}(n);O=x.map(function(t){return l(e,n,y,k,t,P)})}return e.seen.pop(),function(e,t,n){if(e.reduce(function(e,t){return e+t.length+1},0)>60)return n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1];return n[0]+t+" "+e.join(", ")+" "+n[1]}(O,M,E)}function u(e){return"["+Error.prototype.toString.call(e)+"]"}function l(e,t,n,o,i,r){var s,a,u=Object.getOwnPropertyDescriptor(t,i);if(u&&(u.get?a=u.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):u.set&&(a=e.stylize("[Setter]","special"))),o.indexOf(i)<0&&(s="["+i+"]"),a||(e.seen.indexOf(t[i])<0?(a=c(e,t[i],null===n?null:n-1)).indexOf("\n")>-1&&(a=r?a.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+a.split("\n").map(function(e){return"   "+e}).join("\n")):a=e.stylize("[Circular]","special")),void 0===s){if(r&&i.match(/^\d+$/))return a;(s=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=e.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=e.stylize(s,"string"))}return s+": "+a}function h(e){return"object"==typeof e&&"[object RegExp]"===d(e)}function p(e){return"object"==typeof e&&"[object Date]"===d(e)}function f(e){return"object"==typeof e&&"[object Error]"===d(e)}function d(e){return Object.prototype.toString.call(e)}},function(e,t){
/*!
 * assertion-error
 * Copyright(c) 2013 Jake Luer <jake@qualiancy.com>
 * MIT Licensed
 */
/*!
 * Return a function that will copy properties from
 * one object to another excluding any originally
 * listed. Returned function will create a new `{}`.
 *
 * @param {String} excluded properties ...
 * @return {Function}
 */
function n(){var e=[].slice.call(arguments);function t(t,n){Object.keys(n).forEach(function(o){~e.indexOf(o)||(t[o]=n[o])})}return function(){for(var e=[].slice.call(arguments),n=0,o={};n<e.length;n++)t(o,e[n]);return o}}function o(e,t,i){var r=n("name","message","stack","constructor","toJSON")(t||{});for(var s in this.message=e||"Unspecified AssertionError",this.showDiff=!1,r)this[s]=r[s];if(i=i||o,Error.captureStackTrace)Error.captureStackTrace(this,i);else try{throw new Error}catch(e){this.stack=e.stack}}
/*!
 * Inherit from Error.prototype
 */
/*!
 * Primary Exports
 */
e.exports=o,o.prototype=Object.create(Error.prototype),
/*!
 * Statically set name
 */
o.prototype.name="AssertionError",
/*!
 * Ensure correct constructor
 */
o.prototype.constructor=o,o.prototype.toJSON=function(e){var t=n("constructor","toJSON","stack")({name:this.name},this);return!1!==e&&this.stack&&(t.stack=this.stack),t}},function(e,t){
/*!
 * Chai - getActual utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
e.exports=function(e,t){return t.length>4?t[4]:e._obj}},function(e,t,n){
/*!
 * Chai - flag utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
/*!
 * Module dependencies
 */
var o=n(9),i=n(4);e.exports=function(e){var t=o(e),n=Object.prototype.toString.call(e);if(i.truncateThreshold&&t.length>=i.truncateThreshold){if("[object Function]"===n)return e.name&&""!==e.name?"[Function: "+e.name+"]":"[Function]";if("[object Array]"===n)return"[ Array("+e.length+") ]";if("[object Object]"===n){var r=Object.keys(e);return"{ Object ("+(r.length>2?r.splice(0,2).join(", ")+", ...":r.join(", "))+") }"}return t}return t}},function(e,t,n){"use strict";var o=Function.prototype.toString,i=/\s*function(?:\s|\s*\/\*[^(?:*\/)]+\*\/\s*)*([^\s\(\/]+)/;e.exports=function(e){if("function"!=typeof e)return null;var t="";if(void 0===Function.prototype.name&&void 0===e.name){var n=o.call(e).match(i);n&&(t=n[1])}else t=e.name;return t}},function(e,t){
/*!
 * Chai - getProperties utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
e.exports=function(e){var t=Object.getOwnPropertyNames(e);function n(e){-1===t.indexOf(e)&&t.push(e)}for(var o=Object.getPrototypeOf(e);null!==o;)Object.getOwnPropertyNames(o).forEach(n),o=Object.getPrototypeOf(o);return t}},function(e,t){
/*!
 * Chai - getOwnEnumerablePropertySymbols utility
 * Copyright(c) 2011-2016 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
e.exports=function(e){return"function"!=typeof Object.getOwnPropertySymbols?[]:Object.getOwnPropertySymbols(e).filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})}},function(e,t,n){"use strict";const o=n(41),i=n(42);function r(e,t){return t.encode?t.strict?o(e):encodeURIComponent(e):e}function s(e,t){return t.decode?i(e):e}function a(e){const t=e.indexOf("?");return-1===t?"":e.slice(t+1)}function c(e,t){const n=function(e){let t;switch(e.arrayFormat){case"index":return(e,n,o)=>{t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===o[e]&&(o[e]={}),o[e][t[1]]=n):o[e]=n};case"bracket":return(e,n,o)=>{t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==o[e]?o[e]=[].concat(o[e],n):o[e]=[n]:o[e]=n};default:return(e,t,n)=>{void 0!==n[e]?n[e]=[].concat(n[e],t):n[e]=t}}}(t=Object.assign({decode:!0,arrayFormat:"none"},t)),o=Object.create(null);if("string"!=typeof e)return o;if(!(e=e.trim().replace(/^[?#&]/,"")))return o;for(const i of e.split("&")){let[e,r]=i.replace(/\+/g," ").split("=");r=void 0===r?null:s(r,t),n(s(e,t),r,o)}return Object.keys(o).sort().reduce((e,t)=>{const n=o[t];return Boolean(n)&&"object"==typeof n&&!Array.isArray(n)?e[t]=function e(t){return Array.isArray(t)?t.sort():"object"==typeof t?e(Object.keys(t)).sort((e,t)=>Number(e)-Number(t)).map(e=>t[e]):t}(n):e[t]=n,e},Object.create(null))}t.extract=a,t.parse=c,t.stringify=((e,t)=>{if(!e)return"";const n=function(e){switch(e.arrayFormat){case"index":return(t,n,o)=>null===n?[r(t,e),"[",o,"]"].join(""):[r(t,e),"[",r(o,e),"]=",r(n,e)].join("");case"bracket":return(t,n)=>null===n?[r(t,e),"[]"].join(""):[r(t,e),"[]=",r(n,e)].join("");default:return(t,n)=>null===n?r(t,e):[r(t,e),"=",r(n,e)].join("")}}(t=Object.assign({encode:!0,strict:!0,arrayFormat:"none"},t)),o=Object.keys(e);return!1!==t.sort&&o.sort(t.sort),o.map(o=>{const i=e[o];if(void 0===i)return"";if(null===i)return r(o,t);if(Array.isArray(i)){const e=[];for(const t of i.slice())void 0!==t&&e.push(n(o,t,e.length));return e.join("&")}return r(o,t)+"="+r(i,t)}).filter(e=>e.length>0).join("&")}),t.parseUrl=((e,t)=>{const n=e.indexOf("#");return-1!==n&&(e=e.slice(0,n)),{url:e.split("?")[0]||"",query:c(a(e),t)}})},function(e,t,n){parcelRequire=function(t,o,i,r){var s="function"==typeof parcelRequire&&parcelRequire;function a(e,i){if(!o[e]){if(!t[e]){var r="function"==typeof parcelRequire&&parcelRequire;if(!i&&r)return r(e,!0);if(s)return s(e,!0);if("string"==typeof e)return n(43)(e);var c=new Error("Cannot find module '"+e+"'");throw c.code="MODULE_NOT_FOUND",c}l.resolve=function(n){return t[e][1][n]||n},l.cache={};var u=o[e]=new a.Module(e);t[e][0].call(u.exports,l,u,u.exports,this)}return o[e].exports;function l(e){return a(l.resolve(e))}}a.isParcelRequire=!0,a.Module=function(e){this.id=e,this.bundle=a,this.exports={}},a.modules=t,a.cache=o,a.parent=s,a.register=function(e,n){t[e]=[function(e,t){t.exports=n},{}]};for(var c=0;c<i.length;c++)a(i[c]);if(i.length){var u=a(i[i.length-1]);e.exports=u}return a}({vHo1:[function(e,t,n){var o={};o.useBlobBuilder=function(){try{return new Blob([]),!1}catch(e){return!0}}(),o.useArrayBufferView=!o.useBlobBuilder&&function(){try{return 0===new Blob([new Uint8Array([])]).size}catch(e){return!0}}(),t.exports.binaryFeatures=o;var i=t.exports.BlobBuilder;function r(){this._pieces=[],this._parts=[]}"undefined"!=typeof window&&(i=t.exports.BlobBuilder=window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder||window.BlobBuilder),r.prototype.append=function(e){"number"==typeof e?this._pieces.push(e):(this.flush(),this._parts.push(e))},r.prototype.flush=function(){if(this._pieces.length>0){var e=new Uint8Array(this._pieces);o.useArrayBufferView||(e=e.buffer),this._parts.push(e),this._pieces=[]}},r.prototype.getBuffer=function(){if(this.flush(),o.useBlobBuilder){for(var e=new i,t=0,n=this._parts.length;t<n;t++)e.append(this._parts[t]);return e.getBlob()}return new Blob(this._parts)},t.exports.BufferBuilder=r},{}],lHOc:[function(e,t,n){var o=e("./bufferbuilder").BufferBuilder,i=e("./bufferbuilder").binaryFeatures,r={unpack:function(e){return new s(e).unpack()},pack:function(e){var t=new a;return t.pack(e),t.getBuffer()}};function s(e){this.index=0,this.dataBuffer=e,this.dataView=new Uint8Array(this.dataBuffer),this.length=this.dataBuffer.byteLength}function a(){this.bufferBuilder=new o}function c(e){var t=e.charCodeAt(0);return t<=2047?"00":t<=65535?"000":t<=2097151?"0000":t<=67108863?"00000":"000000"}t.exports=r,s.prototype.unpack=function(){var e,t=this.unpack_uint8();if(t<128)return t;if((224^t)<32)return(224^t)-32;if((e=160^t)<=15)return this.unpack_raw(e);if((e=176^t)<=15)return this.unpack_string(e);if((e=144^t)<=15)return this.unpack_array(e);if((e=128^t)<=15)return this.unpack_map(e);switch(t){case 192:return null;case 193:return;case 194:return!1;case 195:return!0;case 202:return this.unpack_float();case 203:return this.unpack_double();case 204:return this.unpack_uint8();case 205:return this.unpack_uint16();case 206:return this.unpack_uint32();case 207:return this.unpack_uint64();case 208:return this.unpack_int8();case 209:return this.unpack_int16();case 210:return this.unpack_int32();case 211:return this.unpack_int64();case 212:case 213:case 214:case 215:return;case 216:return e=this.unpack_uint16(),this.unpack_string(e);case 217:return e=this.unpack_uint32(),this.unpack_string(e);case 218:return e=this.unpack_uint16(),this.unpack_raw(e);case 219:return e=this.unpack_uint32(),this.unpack_raw(e);case 220:return e=this.unpack_uint16(),this.unpack_array(e);case 221:return e=this.unpack_uint32(),this.unpack_array(e);case 222:return e=this.unpack_uint16(),this.unpack_map(e);case 223:return e=this.unpack_uint32(),this.unpack_map(e)}},s.prototype.unpack_uint8=function(){var e=255&this.dataView[this.index];return this.index++,e},s.prototype.unpack_uint16=function(){var e=this.read(2),t=256*(255&e[0])+(255&e[1]);return this.index+=2,t},s.prototype.unpack_uint32=function(){var e=this.read(4),t=256*(256*(256*e[0]+e[1])+e[2])+e[3];return this.index+=4,t},s.prototype.unpack_uint64=function(){var e=this.read(8),t=256*(256*(256*(256*(256*(256*(256*e[0]+e[1])+e[2])+e[3])+e[4])+e[5])+e[6])+e[7];return this.index+=8,t},s.prototype.unpack_int8=function(){var e=this.unpack_uint8();return e<128?e:e-256},s.prototype.unpack_int16=function(){var e=this.unpack_uint16();return e<32768?e:e-65536},s.prototype.unpack_int32=function(){var e=this.unpack_uint32();return e<Math.pow(2,31)?e:e-Math.pow(2,32)},s.prototype.unpack_int64=function(){var e=this.unpack_uint64();return e<Math.pow(2,63)?e:e-Math.pow(2,64)},s.prototype.unpack_raw=function(e){if(this.length<this.index+e)throw new Error("BinaryPackFailure: index is out of range "+this.index+" "+e+" "+this.length);var t=this.dataBuffer.slice(this.index,this.index+e);return this.index+=e,t},s.prototype.unpack_string=function(e){for(var t,n,o=this.read(e),i=0,r="";i<e;)(t=o[i])<128?(r+=String.fromCharCode(t),i++):(192^t)<32?(n=(192^t)<<6|63&o[i+1],r+=String.fromCharCode(n),i+=2):(n=(15&t)<<12|(63&o[i+1])<<6|63&o[i+2],r+=String.fromCharCode(n),i+=3);return this.index+=e,r},s.prototype.unpack_array=function(e){for(var t=new Array(e),n=0;n<e;n++)t[n]=this.unpack();return t},s.prototype.unpack_map=function(e){for(var t={},n=0;n<e;n++){var o=this.unpack(),i=this.unpack();t[o]=i}return t},s.prototype.unpack_float=function(){var e=this.unpack_uint32(),t=(e>>23&255)-127;return(0==e>>31?1:-1)*(8388607&e|8388608)*Math.pow(2,t-23)},s.prototype.unpack_double=function(){var e=this.unpack_uint32(),t=this.unpack_uint32(),n=(e>>20&2047)-1023;return(0==e>>31?1:-1)*((1048575&e|1048576)*Math.pow(2,n-20)+t*Math.pow(2,n-52))},s.prototype.read=function(e){var t=this.index;if(t+e<=this.length)return this.dataView.subarray(t,t+e);throw new Error("BinaryPackFailure: read index out of range")},a.prototype.getBuffer=function(){return this.bufferBuilder.getBuffer()},a.prototype.pack=function(e){var t=typeof e;if("string"==t)this.pack_string(e);else if("number"==t)Math.floor(e)===e?this.pack_integer(e):this.pack_double(e);else if("boolean"==t)!0===e?this.bufferBuilder.append(195):!1===e&&this.bufferBuilder.append(194);else if("undefined"==t)this.bufferBuilder.append(192);else{if("object"!=t)throw new Error('Type "'+t+'" not yet supported');if(null===e)this.bufferBuilder.append(192);else{var n=e.constructor;if(n==Array)this.pack_array(e);else if(n==Blob||n==File)this.pack_bin(e);else if(n==ArrayBuffer)i.useArrayBufferView?this.pack_bin(new Uint8Array(e)):this.pack_bin(e);else if("BYTES_PER_ELEMENT"in e)i.useArrayBufferView?this.pack_bin(new Uint8Array(e.buffer)):this.pack_bin(e.buffer);else if(n==Object)this.pack_object(e);else if(n==Date)this.pack_string(e.toString());else{if("function"!=typeof e.toBinaryPack)throw new Error('Type "'+n.toString()+'" not yet supported');this.bufferBuilder.append(e.toBinaryPack())}}}this.bufferBuilder.flush()},a.prototype.pack_bin=function(e){var t=e.length||e.byteLength||e.size;if(t<=15)this.pack_uint8(160+t);else if(t<=65535)this.bufferBuilder.append(218),this.pack_uint16(t);else{if(!(t<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(219),this.pack_uint32(t)}this.bufferBuilder.append(e)},a.prototype.pack_string=function(e){var t=function(e){return e.length>600?new Blob([e]).size:e.replace(/[^\u0000-\u007F]/g,c).length}(e);if(t<=15)this.pack_uint8(176+t);else if(t<=65535)this.bufferBuilder.append(216),this.pack_uint16(t);else{if(!(t<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(217),this.pack_uint32(t)}this.bufferBuilder.append(e)},a.prototype.pack_array=function(e){var t=e.length;if(t<=15)this.pack_uint8(144+t);else if(t<=65535)this.bufferBuilder.append(220),this.pack_uint16(t);else{if(!(t<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(221),this.pack_uint32(t)}for(var n=0;n<t;n++)this.pack(e[n])},a.prototype.pack_integer=function(e){if(-32<=e&&e<=127)this.bufferBuilder.append(255&e);else if(0<=e&&e<=255)this.bufferBuilder.append(204),this.pack_uint8(e);else if(-128<=e&&e<=127)this.bufferBuilder.append(208),this.pack_int8(e);else if(0<=e&&e<=65535)this.bufferBuilder.append(205),this.pack_uint16(e);else if(-32768<=e&&e<=32767)this.bufferBuilder.append(209),this.pack_int16(e);else if(0<=e&&e<=4294967295)this.bufferBuilder.append(206),this.pack_uint32(e);else if(-2147483648<=e&&e<=2147483647)this.bufferBuilder.append(210),this.pack_int32(e);else if(-0x8000000000000000<=e&&e<=0x8000000000000000)this.bufferBuilder.append(211),this.pack_int64(e);else{if(!(0<=e&&e<=0x10000000000000000))throw new Error("Invalid integer");this.bufferBuilder.append(207),this.pack_uint64(e)}},a.prototype.pack_double=function(e){var t=0;e<0&&(t=1,e=-e);var n=Math.floor(Math.log(e)/Math.LN2),o=e/Math.pow(2,n)-1,i=Math.floor(o*Math.pow(2,52)),r=Math.pow(2,32),s=t<<31|n+1023<<20|i/r&1048575,a=i%r;this.bufferBuilder.append(203),this.pack_int32(s),this.pack_int32(a)},a.prototype.pack_object=function(e){var t=Object.keys(e).length;if(t<=15)this.pack_uint8(128+t);else if(t<=65535)this.bufferBuilder.append(222),this.pack_uint16(t);else{if(!(t<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(223),this.pack_uint32(t)}for(var n in e)e.hasOwnProperty(n)&&(this.pack(n),this.pack(e[n]))},a.prototype.pack_uint8=function(e){this.bufferBuilder.append(e)},a.prototype.pack_uint16=function(e){this.bufferBuilder.append(e>>8),this.bufferBuilder.append(255&e)},a.prototype.pack_uint32=function(e){var t=4294967295&e;this.bufferBuilder.append((4278190080&t)>>>24),this.bufferBuilder.append((16711680&t)>>>16),this.bufferBuilder.append((65280&t)>>>8),this.bufferBuilder.append(255&t)},a.prototype.pack_uint64=function(e){var t=e/Math.pow(2,32),n=e%Math.pow(2,32);this.bufferBuilder.append((4278190080&t)>>>24),this.bufferBuilder.append((16711680&t)>>>16),this.bufferBuilder.append((65280&t)>>>8),this.bufferBuilder.append(255&t),this.bufferBuilder.append((4278190080&n)>>>24),this.bufferBuilder.append((16711680&n)>>>16),this.bufferBuilder.append((65280&n)>>>8),this.bufferBuilder.append(255&n)},a.prototype.pack_int8=function(e){this.bufferBuilder.append(255&e)},a.prototype.pack_int16=function(e){this.bufferBuilder.append((65280&e)>>8),this.bufferBuilder.append(255&e)},a.prototype.pack_int32=function(e){this.bufferBuilder.append(e>>>24&255),this.bufferBuilder.append((16711680&e)>>>16),this.bufferBuilder.append((65280&e)>>>8),this.bufferBuilder.append(255&e)},a.prototype.pack_int64=function(e){var t=Math.floor(e/Math.pow(2,32)),n=e%Math.pow(2,32);this.bufferBuilder.append((4278190080&t)>>>24),this.bufferBuilder.append((16711680&t)>>>16),this.bufferBuilder.append((65280&t)>>>8),this.bufferBuilder.append(255&t),this.bufferBuilder.append((4278190080&n)>>>24),this.bufferBuilder.append((16711680&n)>>>16),this.bufferBuilder.append((65280&n)>>>8),this.bufferBuilder.append(255&n)}},{"./bufferbuilder":"vHo1"}],sXtV:[function(e,t,n){"use strict";n.__esModule=!0,n.RTCSessionDescription=window.RTCSessionDescription||window.mozRTCSessionDescription,n.RTCPeerConnection=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection,n.RTCIceCandidate=window.RTCIceCandidate||window.mozRTCIceCandidate},{}],BHXf:[function(e,t,n){arguments[3],arguments[3];var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};n.__esModule=!0;var i={iceServers:[{urls:"stun:stun.l.google.com:19302"}]},r=1,s=o(e("js-binarypack")),a=e("./adapter");n.util={noop:function(){},CLOUD_HOST:"0.peerjs.com",CLOUD_PORT:443,chunkedBrowsers:{Chrome:1},chunkedMTU:16300,logLevel:0,setLogLevel:function(e){var t=parseInt(e,10);isNaN(parseInt(e,10))?n.util.logLevel=e?3:0:n.util.logLevel=t,n.util.log=n.util.warn=n.util.error=n.util.noop,n.util.logLevel>0&&(n.util.error=n.util._printWith("ERROR")),n.util.logLevel>1&&(n.util.warn=n.util._printWith("WARNING")),n.util.logLevel>2&&(n.util.log=n.util._print)},setLogFunction:function(e){e.constructor!==Function?n.util.warn("The log function you passed in is not a function. Defaulting to regular logs."):n.util._print=e},_printWith:function(e){return function(){var t=Array.prototype.slice.call(arguments);t.unshift(e),n.util._print.apply(n.util,t)}},_print:function(){var e=!1,t=Array.prototype.slice.call(arguments);t.unshift("PeerJS: ");for(var n=0,o=t.length;n<o;n++)t[n]instanceof Error&&(t[n]="("+t[n].name+") "+t[n].message,e=!0);e?console.error.apply(console,t):console.log.apply(console,t)},defaultConfig:i,browser:window.mozRTCPeerConnection?"Firefox":window.webkitRTCPeerConnection?"Chrome":window.RTCPeerConnection?"Supported":"Unsupported",supports:function(){if(void 0===a.RTCPeerConnection)return{};var e,t,n=!0,o=!0,r=!1,s=!1,c=!!window.webkitRTCPeerConnection;try{e=new a.RTCPeerConnection(i,{optional:[{RtpDataChannels:!0}]})}catch(e){n=!1,o=!1}if(n)try{t=e.createDataChannel("_PEERJSTEST")}catch(e){n=!1}if(n){try{t.binaryType="blob",r=!0}catch(e){}var u=new a.RTCPeerConnection(i,{});try{s=u.createDataChannel("_PEERJSRELIABLETEST",{}).reliable}catch(e){}u.close()}return o&&(o=!!e.addStream),e&&e.close(),{audioVideo:o,data:n,binaryBlob:r,binary:s,reliable:s,sctp:s,onnegotiationneeded:c}}(),validateId:function(e){return!e||/^[A-Za-z0-9]+(?:[ _-][A-Za-z0-9]+)*$/.exec(e)},validateKey:function(e){return!e||/^[A-Za-z0-9]+(?:[ _-][A-Za-z0-9]+)*$/.exec(e)},debug:!1,inherits:function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})},extend:function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},pack:s.default.pack,unpack:s.default.unpack,log:function(){if(n.util.debug){var e=!1,t=Array.prototype.slice.call(arguments);t.unshift("PeerJS: ");for(var o=0,i=t.length;o<i;o++)t[o]instanceof Error&&(t[o]="("+t[o].name+") "+t[o].message,e=!0);e?console.error.apply(console,t):console.log.apply(console,t)}},setZeroTimeout:function(e){var t=[],n="zero-timeout-message";function o(o){o.source==e&&o.data==n&&(o.stopPropagation&&o.stopPropagation(),t.length&&t.shift()())}return e.addEventListener?e.addEventListener("message",o,!0):e.attachEvent&&e.attachEvent("onmessage",o),function(o){t.push(o),e.postMessage(n,"*")}}(window),chunk:function(e){for(var t,o=[],i=e.size,s=t=0,a=Math.ceil(i/n.util.chunkedMTU);s<i;){var c=Math.min(i,s+n.util.chunkedMTU),u=e.slice(s,c),l={__peerData:r,n:t,data:u,total:a};o.push(l),s=c,t+=1}return r+=1,o},blobToArrayBuffer:function(e,t){var n=new FileReader;n.onload=function(e){t(e.target.result)},n.readAsArrayBuffer(e)},blobToBinaryString:function(e,t){var n=new FileReader;n.onload=function(e){t(e.target.result)},n.readAsBinaryString(e)},binaryStringToArrayBuffer:function(e){for(var t=new Uint8Array(e.length),n=0;n<e.length;n++)t[n]=255&e.charCodeAt(n);return t.buffer},randomToken:function(){return Math.random().toString(36).substr(2)},isSecure:function(){return"https:"===location.protocol}}},{"js-binarypack":"lHOc","./adapter":"sXtV"}],"2JJl":[function(e,t,n){"use strict";function o(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function i(){}i.prototype._events=void 0,i.prototype.listeners=function(e){if(!this._events||!this._events[e])return[];if(this._events[e].fn)return[this._events[e].fn];for(var t=0,n=this._events[e].length,o=new Array(n);t<n;t++)o[t]=this._events[e][t].fn;return o},i.prototype.emit=function(e,t,n,o,i,r){if(!this._events||!this._events[e])return!1;var s,a,c=this._events[e],u=arguments.length;if("function"==typeof c.fn){switch(c.once&&this.removeListener(e,c.fn,!0),u){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,n),!0;case 4:return c.fn.call(c.context,t,n,o),!0;case 5:return c.fn.call(c.context,t,n,o,i),!0;case 6:return c.fn.call(c.context,t,n,o,i,r),!0}for(a=1,s=new Array(u-1);a<u;a++)s[a-1]=arguments[a];c.fn.apply(c.context,s)}else{var l,h=c.length;for(a=0;a<h;a++)switch(c[a].once&&this.removeListener(e,c[a].fn,!0),u){case 1:c[a].fn.call(c[a].context);break;case 2:c[a].fn.call(c[a].context,t);break;case 3:c[a].fn.call(c[a].context,t,n);break;default:if(!s)for(l=1,s=new Array(u-1);l<u;l++)s[l-1]=arguments[l];c[a].fn.apply(c[a].context,s)}}return!0},i.prototype.on=function(e,t,n){var i=new o(t,n||this);return this._events||(this._events={}),this._events[e]?this._events[e].fn?this._events[e]=[this._events[e],i]:this._events[e].push(i):this._events[e]=i,this},i.prototype.once=function(e,t,n){var i=new o(t,n||this,!0);return this._events||(this._events={}),this._events[e]?this._events[e].fn?this._events[e]=[this._events[e],i]:this._events[e].push(i):this._events[e]=i,this},i.prototype.removeListener=function(e,t,n){if(!this._events||!this._events[e])return this;var o=this._events[e],i=[];if(t&&(o.fn&&(o.fn!==t||n&&!o.once)&&i.push(o),!o.fn))for(var r=0,s=o.length;r<s;r++)(o[r].fn!==t||n&&!o[r].once)&&i.push(o[r]);return i.length?this._events[e]=1===i.length?i[0]:i:delete this._events[e],this},i.prototype.removeAllListeners=function(e){return this._events?(e?delete this._events[e]:this._events={},this):this},i.prototype.off=i.prototype.removeListener,i.prototype.addListener=i.prototype.on,i.prototype.setMaxListeners=function(){return this},i.EventEmitter=i,i.EventEmitter2=i,i.EventEmitter3=i,t.exports=i},{}],wJlv:[function(e,t,n){"use strict";n.__esModule=!0;var o=e("./util"),i=e("eventemitter3");function r(e,t,n,o,s,a){if(!(this instanceof r))return new r(e,t,n,o,s,a);a=a||n,i.EventEmitter.call(this),this.disconnected=!1,this._queue=[];var c=e?"https://":"http://",u=e?"wss://":"ws://";this._httpUrl=c+t+":"+n+o+s,this._wsUrl=u+t+":"+a+o+"peerjs?key="+s}n.Socket=r,o.util.inherits(r,i.EventEmitter),r.prototype.start=function(e,t){this.id=e,this._httpUrl+="/"+e+"/"+t,this._wsUrl+="&id="+e+"&token="+t,this._startXhrStream(),this._startWebSocket()},r.prototype._startWebSocket=function(e){var t=this;this._socket||(this._socket=new WebSocket(this._wsUrl),this._socket.onmessage=function(e){try{var n=JSON.parse(e.data)}catch(t){return void o.util.log("Invalid server message",e.data)}t.emit("message",n)},this._socket.onclose=function(e){o.util.log("Socket closed."),t.disconnected=!0,t.emit("disconnected")},this._socket.onopen=function(){t._timeout&&(clearTimeout(t._timeout),setTimeout(function(){t._http.abort(),t._http=null},5e3)),t._sendQueuedMessages(),o.util.log("Socket open")})},r.prototype._startXhrStream=function(e){try{var t=this;this._http=new XMLHttpRequest,this._http._index=1,this._http._streamIndex=e||0,this._http.open("post",this._httpUrl+"/id?i="+this._http._streamIndex,!0),this._http.onerror=function(){clearTimeout(t._timeout),t.emit("disconnected")},this._http.onreadystatechange=function(){2==this.readyState&&this.old?(this.old.abort(),delete this.old):this.readyState>2&&200===this.status&&this.responseText&&t._handleStream(this)},this._http.send(null),this._setHTTPTimeout()}catch(e){o.util.log("XMLHttpRequest not available; defaulting to WebSockets")}},r.prototype._handleStream=function(e){var t=e.responseText.split("\n");if(e._buffer)for(;e._buffer.length>0;){var n=e._buffer.shift(),i=t[n];try{i=JSON.parse(i)}catch(t){e._buffer.shift(n);break}this.emit("message",i)}var r=t[e._index];if(r)if(e._index+=1,e._index===t.length)e._buffer||(e._buffer=[]),e._buffer.push(e._index-1);else{try{r=JSON.parse(r)}catch(e){return void o.util.log("Invalid server message",r)}this.emit("message",r)}},r.prototype._setHTTPTimeout=function(){var e=this;this._timeout=setTimeout(function(){var t=e._http;e._wsOpen()?t.abort():(e._startXhrStream(t._streamIndex+1),e._http.old=t)},25e3)},r.prototype._wsOpen=function(){return this._socket&&1==this._socket.readyState},r.prototype._sendQueuedMessages=function(){for(var e=0,t=this._queue.length;e<t;e+=1)this.send(this._queue[e])},r.prototype.send=function(e){if(!this.disconnected)if(this.id)if(e.type){var t=JSON.stringify(e);if(this._wsOpen())this._socket.send(t);else{var n=new XMLHttpRequest,o=this._httpUrl+"/"+e.type.toLowerCase();n.open("post",o,!0),n.setRequestHeader("Content-Type","application/json"),n.send(t)}}else this.emit("error","Invalid message");else this._queue.push(e)},r.prototype.close=function(){!this.disconnected&&this._wsOpen()&&(this._socket.close(),this.disconnected=!0)}},{"./util":"BHXf",eventemitter3:"2JJl"}],HCdX:[function(e,t,n){"use strict";n.__esModule=!0;var o=e("./util"),i=e("./adapter");function r(e,t){"addTrack"in t?e.getTracks().forEach(function(n){t.addTrack(n,e)}):"addStream"in t&&t.addStream(e)}n.Negotiator={pcs:{data:{},media:{}},queue:[]},n.Negotiator._idPrefix="pc_",n.Negotiator.startConnection=function(e,t){var i=n.Negotiator._getPeerConnection(e,t);if(e.pc=e.peerConnection=i,"media"===e.type&&t._stream&&r(t._stream,i),t.originator){if("data"===e.type){var s={};o.util.supports.sctp||(s={reliable:t.reliable});var a=i.createDataChannel(e.label,s);e.initialize(a)}n.Negotiator._makeOffer(e)}else n.Negotiator.handleSDP("OFFER",e,t.sdp)},n.Negotiator._getPeerConnection=function(e,t){var i;return n.Negotiator.pcs[e.type]||o.util.error(e.type+" is not a valid connection type. Maybe you overrode the `type` property somewhere."),n.Negotiator.pcs[e.type][e.peer]||(n.Negotiator.pcs[e.type][e.peer]={}),n.Negotiator.pcs[e.type][e.peer],t.pc&&(i=n.Negotiator.pcs[e.type][e.peer][t.pc]),i&&"stable"===i.signalingState||(i=n.Negotiator._startPeerConnection(e)),i},n.Negotiator._startPeerConnection=function(e){o.util.log("Creating RTCPeerConnection.");var t=n.Negotiator._idPrefix+o.util.randomToken(),r={};"data"!==e.type||o.util.supports.sctp?"media"===e.type&&(r={optional:[{DtlsSrtpKeyAgreement:!0}]}):r={optional:[{RtpDataChannels:!0}]};var s=new i.RTCPeerConnection(e.provider.options.config,r);return n.Negotiator.pcs[e.type][e.peer][t]=s,n.Negotiator._setupListeners(e,s,t),s},n.Negotiator._setupListeners=function(e,t,n){var i=e.peer,s=e.id,a=e.provider;o.util.log("Listening for ICE candidates."),t.onicecandidate=function(t){t.candidate&&(o.util.log("Received ICE candidates for:",e.peer),a.socket.send({type:"CANDIDATE",payload:{candidate:t.candidate,type:e.type,connectionId:e.id},dst:i}))},t.oniceconnectionstatechange=function(){switch(t.iceConnectionState){case"failed":o.util.log("iceConnectionState is disconnected, closing connections to "+i),e.emit("error",new Error("Negotiation of connection to "+i+" failed.")),e.close();break;case"disconnected":o.util.log("iceConnectionState is disconnected, closing connections to "+i);break;case"completed":t.onicecandidate=o.util.noop}},t.onicechange=t.oniceconnectionstatechange,o.util.log("Listening for data channel"),t.ondatachannel=function(e){o.util.log("Received data channel");var t=e.channel;a.getConnection(i,s).initialize(t)},o.util.log("Listening for remote stream"),t.ontrack=function(e){o.util.log("Received remote stream");var t=e.streams[0],n=a.getConnection(i,s);"media"===n.type&&r(t,n)}},n.Negotiator.cleanup=function(e){o.util.log("Cleaning up PeerConnection to "+e.peer);var t=e.pc;t&&(t.readyState&&"closed"!==t.readyState||"closed"!==t.signalingState)&&(t.close(),e.pc=null)},n.Negotiator._makeOffer=function(e){var t=e.pc,n=function(n){o.util.log("Created offer."),!o.util.supports.sctp&&"data"===e.type&&e.reliable&&(n.sdp=Reliable.higherBandwidthSDP(n.sdp)),t.setLocalDescription(n).then(function(){return o.util.log("Set localDescription: offer","for:",e.peer),void e.provider.socket.send({type:"OFFER",payload:{sdp:n,type:e.type,label:e.label,connectionId:e.id,reliable:e.reliable,serialization:e.serialization,metadata:e.metadata,browser:o.util.browser},dst:e.peer})}).catch(function(t){return function(t){"OperationError: Failed to set local offer sdp: Called in wrong state: kHaveRemoteOffer"!=t&&(e.provider.emitError("webrtc",t),o.util.log("Failed to setLocalDescription, ",t))}(t)})};t.createOffer(e.options.constraints).then(function(e){return n(e)}).catch(function(t){return function(t){e.provider.emitError("webrtc",t),o.util.log("Failed to createOffer, ",t)}(t)})},n.Negotiator._makeAnswer=function(e){var t=e.pc,n=function(n){o.util.log("Created answer."),!o.util.supports.sctp&&"data"===e.type&&e.reliable&&(n.sdp=Reliable.higherBandwidthSDP(n.sdp)),t.setLocalDescription(n).then(function(){return o.util.log("Set localDescription: answer","for:",e.peer),void e.provider.socket.send({type:"ANSWER",payload:{sdp:n,type:e.type,connectionId:e.id,browser:o.util.browser},dst:e.peer})}).catch(function(t){e.provider.emitError("webrtc",t),o.util.log("Failed to setLocalDescription, ",t)})};t.createAnswer().then(function(e){return n(e)}).catch(function(t){e.provider.emitError("webrtc",t),o.util.log("Failed to create answer, ",t)})},n.Negotiator.handleSDP=function(e,t,r){r=new i.RTCSessionDescription(r);var s=t.pc;o.util.log("Setting remote description",r),s.setRemoteDescription(r).then(function(){return o.util.log("Set remoteDescription:",e,"for:",t.peer),void("OFFER"===e&&n.Negotiator._makeAnswer(t))}).catch(function(e){t.provider.emitError("webrtc",e),o.util.log("Failed to setRemoteDescription, ",e)})},n.Negotiator.handleCandidate=function(e,t){var n=t.candidate,r=t.sdpMLineIndex;e.pc.addIceCandidate(new i.RTCIceCandidate({sdpMLineIndex:r,candidate:n})),o.util.log("Added ICE candidate for:",e.peer)}},{"./util":"BHXf","./adapter":"sXtV"}],dbHP:[function(e,t,n){"use strict";n.__esModule=!0;var o=e("./util"),i=e("eventemitter3"),r=e("./negotiator");function s(e,t,n){if(!(this instanceof s))return new s(e,t,n);i.EventEmitter.call(this),this.options=o.util.extend({},n),this.open=!1,this.type="media",this.peer=e,this.provider=t,this.metadata=this.options.metadata,this.localStream=this.options._stream,this.id=this.options.connectionId||s._idPrefix+o.util.randomToken(),this.localStream&&r.Negotiator.startConnection(this,{_stream:this.localStream,originator:!0})}n.MediaConnection=s,o.util.inherits(s,i.EventEmitter),s._idPrefix="mc_",s.prototype.addStream=function(e){o.util.log("Receiving stream",e),this.remoteStream=e,this.emit("stream",e)},s.prototype.handleMessage=function(e){var t=e.payload;switch(e.type){case"ANSWER":r.Negotiator.handleSDP(e.type,this,t.sdp),this.open=!0;break;case"CANDIDATE":r.Negotiator.handleCandidate(this,t.candidate);break;default:o.util.warn("Unrecognized message type:",e.type,"from peer:",this.peer)}},s.prototype.answer=function(e){if(this.localStream)o.util.warn("Local stream already exists on this MediaConnection. Are you answering a call twice?");else{this.options._payload._stream=e,this.localStream=e,r.Negotiator.startConnection(this,this.options._payload);for(var t=this.provider._getMessages(this.id),n=0,i=t.length;n<i;n+=1)this.handleMessage(t[n]);this.open=!0}},s.prototype.close=function(){this.open&&(this.open=!1,r.Negotiator.cleanup(this),this.emit("close"))}},{"./util":"BHXf",eventemitter3:"2JJl","./negotiator":"HCdX"}],T9kO:[function(e,t,n){arguments[3],arguments[3];var o=e("js-binarypack"),i={debug:!1,inherits:function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})},extend:function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},pack:o.pack,unpack:o.unpack,log:function(){if(i.debug){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];e.unshift("Reliable: "),console.log.apply(console,e)}},setZeroTimeout:function(e){var t=[],n="zero-timeout-message";function o(o){o.source==e&&o.data==n&&(o.stopPropagation&&o.stopPropagation(),t.length&&t.shift()())}return e.addEventListener?e.addEventListener("message",o,!0):e.attachEvent&&e.attachEvent("onmessage",o),function(o){t.push(o),e.postMessage(n,"*")}}(this),blobToArrayBuffer:function(e,t){var n=new FileReader;n.onload=function(e){t(e.target.result)},n.readAsArrayBuffer(e)},blobToBinaryString:function(e,t){var n=new FileReader;n.onload=function(e){t(e.target.result)},n.readAsBinaryString(e)},binaryStringToArrayBuffer:function(e){for(var t=new Uint8Array(e.length),n=0;n<e.length;n++)t[n]=255&e.charCodeAt(n);return t.buffer},randomToken:function(){return Math.random().toString(36).substr(2)}};t.exports=i},{"js-binarypack":"lHOc"}],aYFJ:[function(e,t,n){var o=e("./util");function i(e,t){if(!(this instanceof i))return new i(e);this._dc=e,o.debug=t,this._outgoing={},this._incoming={},this._received={},this._window=1e3,this._mtu=500,this._interval=0,this._count=0,this._queue=[],this._setupDC()}i.prototype.send=function(e){var t=o.pack(e);t.size<this._mtu?this._handleSend(["no",t]):(this._outgoing[this._count]={ack:0,chunks:this._chunk(t)},o.debug&&(this._outgoing[this._count].timer=new Date),this._sendWindowedChunks(this._count),this._count+=1)},i.prototype._setupInterval=function(){var e=this;this._timeout=setInterval(function(){var t=e._queue.shift();if(t._multiple)for(var n=0,o=t.length;n<o;n+=1)e._intervalSend(t[n]);else e._intervalSend(t)},this._interval)},i.prototype._intervalSend=function(e){var t=this;e=o.pack(e),o.blobToBinaryString(e,function(e){t._dc.send(e)}),0===t._queue.length&&(clearTimeout(t._timeout),t._timeout=null)},i.prototype._processAcks=function(){for(var e in this._outgoing)this._outgoing.hasOwnProperty(e)&&this._sendWindowedChunks(e)},i.prototype._handleSend=function(e){for(var t=!0,n=0,o=this._queue.length;n<o;n+=1){var i=this._queue[n];i===e?t=!1:i._multiple&&-1!==i.indexOf(e)&&(t=!1)}t&&(this._queue.push(e),this._timeout||this._setupInterval())},i.prototype._setupDC=function(){var e=this;this._dc.onmessage=function(t){var n=t.data;if(n.constructor===String){var i=o.binaryStringToArrayBuffer(n);n=o.unpack(i),e._handleMessage(n)}}},i.prototype._handleMessage=function(e){var t,n=e[1],i=this._incoming[n],r=this._outgoing[n];switch(e[0]){case"no":var s=n;s&&this.onmessage(o.unpack(s));break;case"end":if(t=i,this._received[n]=e[2],!t)break;this._ack(n);break;case"ack":if(t=r){var a=e[2];t.ack=Math.max(a,t.ack),t.ack>=t.chunks.length?(o.log("Time: ",new Date-t.timer),delete this._outgoing[n]):this._processAcks()}break;case"chunk":if(!(t=i)){if(!0===this._received[n])break;t={ack:["ack",n,0],chunks:[]},this._incoming[n]=t}var c=e[2],u=e[3];t.chunks[c]=new Uint8Array(u),c===t.ack[2]&&this._calculateNextAck(n),this._ack(n);break;default:this._handleSend(e)}},i.prototype._chunk=function(e){for(var t=[],n=e.size,i=0;i<n;){var r=Math.min(n,i+this._mtu),s={payload:e.slice(i,r)};t.push(s),i=r}return o.log("Created",t.length,"chunks."),t},i.prototype._ack=function(e){var t=this._incoming[e].ack;this._received[e]===t[2]&&(this._complete(e),this._received[e]=!0),this._handleSend(t)},i.prototype._calculateNextAck=function(e){for(var t=this._incoming[e],n=t.chunks,o=0,i=n.length;o<i;o+=1)if(void 0===n[o])return void(t.ack[2]=o);t.ack[2]=n.length},i.prototype._sendWindowedChunks=function(e){o.log("sendWindowedChunks for: ",e);for(var t=this._outgoing[e],n=t.chunks,i=[],r=Math.min(t.ack+this._window,n.length),s=t.ack;s<r;s+=1)n[s].sent&&s!==t.ack||(n[s].sent=!0,i.push(["chunk",e,s,n[s].payload]));t.ack+this._window>=n.length&&i.push(["end",e,n.length]),i._multiple=!0,this._handleSend(i)},i.prototype._complete=function(e){o.log("Completed called for",e);var t=this,n=this._incoming[e].chunks,i=new Blob(n);o.blobToArrayBuffer(i,function(e){t.onmessage(o.unpack(e))}),delete this._incoming[e]},i.higherBandwidthSDP=function(e){var t=navigator.appVersion.match(/Chrome\/(.*?) /);if(t&&(t=parseInt(t[1].split(".").shift()))<31){var n=e.split("b=AS:30");if(n.length>1)return n[0]+"b=AS:102400"+n[1]}return e},i.prototype.onmessage=function(e){},t.exports.Reliable=i},{"./util":"T9kO"}],GBTQ:[function(e,t,n){"use strict";n.__esModule=!0;var o=e("./util"),i=e("eventemitter3"),r=e("./negotiator"),s=e("reliable");function a(e,t,n){if(!(this instanceof a))return new a(e,t,n);i.EventEmitter.call(this),this.options=o.util.extend({serialization:"binary",reliable:!1},n),this.open=!1,this.type="data",this.peer=e,this.provider=t,this.id=this.options.connectionId||a._idPrefix+o.util.randomToken(),this.label=this.options.label||this.id,this.metadata=this.options.metadata,this.serialization=this.options.serialization,this.reliable=this.options.reliable,this._buffer=[],this._buffering=!1,this.bufferSize=0,this._chunkedData={},this.options._payload&&(this._peerBrowser=this.options._payload.browser),r.Negotiator.startConnection(this,this.options._payload||{originator:!0})}n.DataConnection=a,o.util.inherits(a,i.EventEmitter),a._idPrefix="dc_",a.prototype.initialize=function(e){this._dc=this.dataChannel=e,this._configureDataChannel()},a.prototype._configureDataChannel=function(){var e=this;o.util.supports.sctp&&(this._dc.binaryType="arraybuffer"),this._dc.onopen=function(){o.util.log("Data channel connection success"),e.open=!0,e.emit("open")},!o.util.supports.sctp&&this.reliable&&(this._reliable=new s.Reliable(this._dc,o.util.debug)),this._reliable?this._reliable.onmessage=function(t){e.emit("data",t)}:this._dc.onmessage=function(t){e._handleDataMessage(t)},this._dc.onclose=function(t){o.util.log("DataChannel closed for:",e.peer),e.close()}},a.prototype._handleDataMessage=function(e){var t=this,n=e.data,i=n.constructor;if("binary"===this.serialization||"binary-utf8"===this.serialization){if(i===Blob)return void o.util.blobToArrayBuffer(n,function(e){n=o.util.unpack(e),t.emit("data",n)});if(i===ArrayBuffer)n=o.util.unpack(n);else if(i===String){var r=o.util.binaryStringToArrayBuffer(n);n=o.util.unpack(r)}}else"json"===this.serialization&&(n=JSON.parse(n));if(n.__peerData){var s=n.__peerData,a=this._chunkedData[s]||{data:[],count:0,total:n.total};return a.data[n.n]=n.data,a.count+=1,a.total===a.count&&(delete this._chunkedData[s],n=new Blob(a.data),this._handleDataMessage({data:n})),void(this._chunkedData[s]=a)}this.emit("data",n)},a.prototype.close=function(){this.open&&(this.open=!1,r.Negotiator.cleanup(this),this.emit("close"))},a.prototype.send=function(e,t){if(this.open)if(this._reliable)this._reliable.send(e);else{var n=this;if("json"===this.serialization)this._bufferedSend(JSON.stringify(e));else if("binary"===this.serialization||"binary-utf8"===this.serialization){var i=o.util.pack(e);if((o.util.chunkedBrowsers[this._peerBrowser]||o.util.chunkedBrowsers[o.util.browser])&&!t&&i.size>o.util.chunkedMTU)return void this._sendChunks(i);o.util.supports.sctp?o.util.supports.binaryBlob?this._bufferedSend(i):o.util.blobToArrayBuffer(i,function(e){n._bufferedSend(e)}):o.util.blobToBinaryString(i,function(e){n._bufferedSend(e)})}else this._bufferedSend(e)}else this.emit("error",new Error("Connection is not open. You should listen for the `open` event before sending messages."))},a.prototype._bufferedSend=function(e){!this._buffering&&this._trySend(e)||(this._buffer.push(e),this.bufferSize=this._buffer.length)},a.prototype._trySend=function(e){try{this._dc.send(e)}catch(e){this._buffering=!0;var t=this;return setTimeout(function(){t._buffering=!1,t._tryBuffer()},100),!1}return!0},a.prototype._tryBuffer=function(){if(0!==this._buffer.length){var e=this._buffer[0];this._trySend(e)&&(this._buffer.shift(),this.bufferSize=this._buffer.length,this._tryBuffer())}},a.prototype._sendChunks=function(e){for(var t=o.util.chunk(e),n=0,i=t.length;n<i;n+=1)e=t[n],this.send(e,!0)},a.prototype.handleMessage=function(e){var t=e.payload;switch(e.type){case"ANSWER":this._peerBrowser=t.browser,r.Negotiator.handleSDP(e.type,this,t.sdp);break;case"CANDIDATE":r.Negotiator.handleCandidate(this,t.candidate);break;default:o.util.warn("Unrecognized message type:",e.type,"from peer:",this.peer)}}},{"./util":"BHXf",eventemitter3:"2JJl","./negotiator":"HCdX",reliable:"aYFJ"}],Hxpd:[function(e,t,n){"use strict";n.__esModule=!0;var o=e("./util"),i=e("eventemitter3"),r=e("./socket"),s=e("./mediaconnection"),a=e("./dataconnection");function c(e,t){if(!(this instanceof c))return new c(e,t);i.EventEmitter.call(this),e&&e.constructor==Object?(t=e,e=void 0):e&&(e=e.toString()),(t=o.util.extend({debug:0,host:o.util.CLOUD_HOST,port:o.util.CLOUD_PORT,path:"/",token:o.util.randomToken(),config:o.util.defaultConfig},t)).key="peerjs",this.options=t,"/"===t.host&&(t.host=window.location.hostname),"/"!==t.path[0]&&(t.path="/"+t.path),"/"!==t.path[t.path.length-1]&&(t.path+="/"),void 0===t.secure&&t.host!==o.util.CLOUD_HOST?t.secure=o.util.isSecure():t.host==o.util.CLOUD_HOST&&(t.secure=!0),t.logFunction&&o.util.setLogFunction(t.logFunction),o.util.setLogLevel(t.debug),o.util.supports.audioVideo||o.util.supports.data?o.util.validateId(e)?(this.destroyed=!1,this.disconnected=!1,this.open=!1,this.connections={},this._lostMessages={},this._initializeServerConnection(),e?this._initialize(e):this._retrieveId()):this._delayedAbort("invalid-id",'ID "'+e+'" is invalid'):this._delayedAbort("browser-incompatible","The current browser does not support WebRTC")}n.Peer=c,o.util.inherits(c,i.EventEmitter),c.prototype._initializeServerConnection=function(){var e=this;this.socket=new r.Socket(this.options.secure,this.options.host,this.options.port,this.options.path,this.options.key,this.options.wsport),this.socket.on("message",function(t){e._handleMessage(t)}),this.socket.on("error",function(t){e._abort("socket-error",t)}),this.socket.on("disconnected",function(){e.disconnected||(e.emitError("network","Lost connection to server."),e.disconnect())}),this.socket.on("close",function(){e.disconnected||e._abort("socket-closed","Underlying socket is already closed.")})},c.prototype._retrieveId=function(e){var t=this,n=new XMLHttpRequest,i=(this.options.secure?"https://":"http://")+this.options.host+":"+this.options.port+this.options.path+this.options.key+"/id";i+="?ts="+(new Date).getTime()+Math.random(),n.open("get",i,!0),n.onerror=function(e){o.util.error("Error retrieving ID",e);var n="";"/"===t.options.path&&t.options.host!==o.util.CLOUD_HOST&&(n=" If you passed in a `path` to your self-hosted PeerServer, you'll also need to pass in that same path when creating a new Peer."),t._abort("server-error","Could not get an ID from the server."+n)},n.onreadystatechange=function(){4===n.readyState&&(200===n.status?t._initialize(n.responseText):n.onerror())},n.send(null)},c.prototype._initialize=function(e){this.id=e,this.socket.start(this.id,this.options.token)},c.prototype._handleMessage=function(e){var t,n=e.type,i=e.payload,r=e.src;switch(n){case"OPEN":this.emit("open",this.id),this.open=!0;break;case"ERROR":this._abort("server-error",i.msg);break;case"ID-TAKEN":this._abort("unavailable-id","ID `"+this.id+"` is taken");break;case"INVALID-KEY":this._abort("invalid-key",'API KEY "'+this.options.key+'" is invalid');break;case"LEAVE":o.util.log("Received leave message from",r),this._cleanupPeer(r);break;case"EXPIRE":this.emitError("peer-unavailable","Could not connect to peer "+r);break;case"OFFER":var c=i.connectionId;if((t=this.getConnection(r,c))&&(t.close(),o.util.warn("Offer received for existing Connection ID:",c)),"media"===i.type)t=new s.MediaConnection(r,this,{connectionId:c,_payload:i,metadata:i.metadata}),this._addConnection(r,t),this.emit("call",t);else{if("data"!==i.type)return void o.util.warn("Received malformed connection type:",i.type);t=new a.DataConnection(r,this,{connectionId:c,_payload:i,metadata:i.metadata,label:i.label,serialization:i.serialization,reliable:i.reliable}),this._addConnection(r,t),this.emit("connection",t)}for(var u=this._getMessages(c),l=0,h=u.length;l<h;l+=1)t.handleMessage(u[l]);break;default:if(!i)return void o.util.warn("You received a malformed message from "+r+" of type "+n);var p=i.connectionId;(t=this.getConnection(r,p))&&t.pc?t.handleMessage(e):p?this._storeMessage(p,e):o.util.warn("You received an unrecognized message:",e)}},c.prototype._storeMessage=function(e,t){this._lostMessages[e]||(this._lostMessages[e]=[]),this._lostMessages[e].push(t)},c.prototype._getMessages=function(e){var t=this._lostMessages[e];return t?(delete this._lostMessages[e],t):[]},c.prototype.connect=function(e,t){if(this.disconnected)return o.util.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect, or call reconnect on this peer if you believe its ID to still be available."),void this.emitError("disconnected","Cannot connect to new Peer after disconnecting from server.");var n=new a.DataConnection(e,this,t);return this._addConnection(e,n),n},c.prototype.call=function(e,t,n){if(this.disconnected)return o.util.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect."),void this.emitError("disconnected","Cannot connect to new Peer after disconnecting from server.");if(t){(n=n||{})._stream=t;var i=new s.MediaConnection(e,this,n);return this._addConnection(e,i),i}o.util.error("To call a peer, you must provide a stream from your browser's `getUserMedia`.")},c.prototype._addConnection=function(e,t){this.connections[e]||(this.connections[e]=[]),this.connections[e].push(t)},c.prototype.getConnection=function(e,t){var n=this.connections[e];if(!n)return null;for(var o=0,i=n.length;o<i;o++)if(n[o].id===t)return n[o];return null},c.prototype._delayedAbort=function(e,t){var n=this;o.util.setZeroTimeout(function(){n._abort(e,t)})},c.prototype._abort=function(e,t){o.util.error("Aborting!"),this._lastServerId?this.disconnect():this.destroy(),this.emitError(e,t)},c.prototype.emitError=function(e,t){o.util.error("Error:",t),"string"==typeof t&&(t=new Error(t)),t.type=e,this.emit("error",t)},c.prototype.destroy=function(){this.destroyed||(this._cleanup(),this.disconnect(),this.destroyed=!0)},c.prototype._cleanup=function(){if(this.connections)for(var e=Object.keys(this.connections),t=0,n=e.length;t<n;t++)this._cleanupPeer(e[t]);this.emit("close")},c.prototype._cleanupPeer=function(e){for(var t=this.connections[e],n=0,o=t.length;n<o;n+=1)t[n].close()},c.prototype.disconnect=function(){var e=this;o.util.setZeroTimeout(function(){e.disconnected||(e.disconnected=!0,e.open=!1,e.socket&&e.socket.close(),e.emit("disconnected",e.id),e._lastServerId=e.id,e.id=null)})},c.prototype.reconnect=function(){if(this.disconnected&&!this.destroyed)o.util.log("Attempting reconnection to server with ID "+this._lastServerId),this.disconnected=!1,this._initializeServerConnection(),this._initialize(this._lastServerId);else{if(this.destroyed)throw new Error("This peer cannot reconnect to the server. It has already been destroyed.");if(this.disconnected||this.open)throw new Error("Peer "+this.id+" cannot reconnect because it is not disconnected from the server!");o.util.error("In a hurry? We're still trying to make the initial connection!")}},c.prototype.listAllPeers=function(e){e=e||function(){};var t=this,n=new XMLHttpRequest,i=(this.options.secure?"https://":"http://")+this.options.host+":"+this.options.port+this.options.path+this.options.key+"/peers";i+="?ts="+(new Date).getTime()+Math.random(),n.open("get",i,!0),n.onerror=function(n){t._abort("server-error","Could not get peers from the server."),e([])},n.onreadystatechange=function(){if(4===n.readyState){if(401===n.status){var i;throw i=t.options.host!==o.util.CLOUD_HOST?"It looks like you're using the cloud server. You can email team@peerjs.com to enable peer listing for your API key.":"You need to enable `allow_discovery` on your self-hosted PeerServer to use this feature.",e([]),new Error("It doesn't look like you have permission to list peers IDs. "+i)}200!==n.status?e([]):e(JSON.parse(n.responseText))}},n.send(null)}},{"./util":"BHXf",eventemitter3:"2JJl","./socket":"wJlv","./mediaconnection":"dbHP","./dataconnection":"GBTQ"}],iTK6:[function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};n.__esModule=!0;var i=e("./util"),r=e("./adapter"),s=e("./socket"),a=e("./mediaconnection"),c=e("./dataconnection"),u=e("./peer"),l=e("./negotiator"),h=o(e("js-binarypack"));window.Socket=s.Socket,window.MediaConnection=a.MediaConnection,window.DataConnection=c.DataConnection,window.Peer=u.Peer,window.RTCPeerConnection=r.RTCPeerConnection,window.RTCSessionDescription=r.RTCSessionDescription,window.RTCIceCandidate=r.RTCIceCandidate,window.Negotiator=l.Negotiator,window.util=i.util,window.BinaryPack=h.default,n.default=u.Peer},{"./util":"BHXf","./adapter":"sXtV","./socket":"wJlv","./mediaconnection":"dbHP","./dataconnection":"GBTQ","./peer":"Hxpd","./negotiator":"HCdX","js-binarypack":"lHOc"}]},{},["iTK6"])},function(e,t,n){
/*!
 * chai
 * Copyright(c) 2011 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
/*!
 * Dependencies that are used for multiple exports are required here only once
 */
var o=n(19);
/*!
 * test utility
 */t.test=n(20),
/*!
 * type utility
 */
t.type=n(8),
/*!
 * expectTypes utility
 */
t.expectTypes=n(22),
/*!
 * message utility
 */
t.getMessage=n(23),
/*!
 * actual utility
 */
t.getActual=n(11),
/*!
 * Inspect util
 */
t.inspect=n(9),
/*!
 * Object Display util
 */
t.objDisplay=n(12),
/*!
 * Flag utility
 */
t.flag=n(1),
/*!
 * Flag transferring utility
 */
t.transferFlags=n(3),
/*!
 * Deep equal utility
 */
t.eql=n(25),
/*!
 * Deep path info
 */
t.getPathInfo=o.getPathInfo,
/*!
 * Check if a property exists
 */
t.hasProperty=o.hasProperty,
/*!
 * Function name
 */
t.getName=n(13),
/*!
 * add Property
 */
t.addProperty=n(26),
/*!
 * add Method
 */
t.addMethod=n(27),
/*!
 * overwrite Property
 */
t.overwriteProperty=n(28),
/*!
 * overwrite Method
 */
t.overwriteMethod=n(29),
/*!
 * Add a chainable method
 */
t.addChainableMethod=n(30),
/*!
 * Overwrite chainable method
 */
t.overwriteChainableMethod=n(31),
/*!
 * Compare by inspect method
 */
t.compareByInspect=n(32),
/*!
 * Get own enumerable property symbols method
 */
t.getOwnEnumerablePropertySymbols=n(15),
/*!
 * Get own enumerable properties method
 */
t.getOwnEnumerableProperties=n(33),
/*!
 * Checks error against a given set of criteria
 */
t.checkError=n(34),
/*!
 * Proxify util
 */
t.proxify=n(7),
/*!
 * addLengthGuard util
 */
t.addLengthGuard=n(6),
/*!
 * isProxyEnabled helper
 */
t.isProxyEnabled=n(5),
/*!
 * isNaN method
 */
t.isNaN=n(35)},function(e,t,n){"use strict";function o(e,t){return null!=e&&t in Object(e)}function i(e){return e.replace(/([^\\])\[/g,"$1.[").match(/(\\\.|[^.]+?)+/g).map(function(e){var t=/^\[(\d+)\]$/.exec(e);return t?{i:parseFloat(t[1])}:{p:e.replace(/\\([.\[\]])/g,"$1")}})}function r(e,t,n){var o=e,i=null;n=void 0===n?t.length:n;for(var r=0;r<n;r++){var s=t[r];o&&(o=void 0===s.p?o[s.i]:o[s.p],r===n-1&&(i=o))}return i}function s(e,t){var n=i(t),s=n[n.length-1],a={parent:n.length>1?r(e,n,n.length-1):e,name:s.p||s.i,value:r(e,n)};return a.exists=o(a.parent,a.name),a}e.exports={hasProperty:o,getPathInfo:s,getPathValue:function(e,t){return s(e,t).value},setPathValue:function(e,t,n){return function(e,t,n){for(var o=e,i=n.length,r=null,s=0;s<i;s++){var a=null,c=null;if(r=n[s],s===i-1)o[a=void 0===r.p?r.i:r.p]=t;else if(void 0!==r.p&&o[r.p])o=o[r.p];else if(void 0!==r.i&&o[r.i])o=o[r.i];else{var u=n[s+1];a=void 0===r.p?r.i:r.p,c=void 0===u.p?[]:{},o[a]=c,o=o[a]}}}(e,n,i(t)),e}}},function(e,t,n){
/*!
 * Chai - test utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
/*!
 * Module dependencies
 */
var o=n(1);e.exports=function(e,t){var n=o(e,"negate"),i=t[0];return n?!i:i}},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){
/*!
 * Chai - expectTypes utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
var o=n(10),i=n(1),r=n(8);e.exports=function(e,t){var n=i(e,"message"),s=i(e,"ssfi");n=n?n+": ":"",e=i(e,"object"),(t=t.map(function(e){return e.toLowerCase()})).sort();var a=t.map(function(e,n){var o=~["a","e","i","o","u"].indexOf(e.charAt(0))?"an":"a";return(t.length>1&&n===t.length-1?"or ":"")+o+" "+e}).join(", "),c=r(e).toLowerCase();if(!t.some(function(e){return c===e}))throw new o(n+"object tested must be "+a+", but "+c+" given",void 0,s)}},function(e,t,n){
/*!
 * Chai - message composition utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
/*!
 * Module dependencies
 */
var o=n(1),i=n(11),r=n(12);e.exports=function(e,t){var n=o(e,"negate"),s=o(e,"object"),a=t[3],c=i(e,t),u=n?t[2]:t[1],l=o(e,"message");return"function"==typeof u&&(u=u()),u=(u=u||"").replace(/#\{this\}/g,function(){return r(s)}).replace(/#\{act\}/g,function(){return r(c)}).replace(/#\{exp\}/g,function(){return r(a)}),l?l+": "+u:u}},function(e,t){
/*!
 * Chai - getEnumerableProperties utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
e.exports=function(e){var t=[];for(var n in e)t.push(n);return t}},function(e,t,n){"use strict";
/*!
 * deep-eql
 * Copyright(c) 2013 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */var o=n(8);function i(){this._key="chai/deep-eql__"+Math.random()+Date.now()}i.prototype={get:function(e){return e[this._key]},set:function(e,t){Object.isExtensible(e)&&Object.defineProperty(e,this._key,{value:t,configurable:!0})}};var r="function"==typeof WeakMap?WeakMap:i;
/*!
 * Check to see if the MemoizeMap has recorded a result of the two operands
 *
 * @param {Mixed} leftHandOperand
 * @param {Mixed} rightHandOperand
 * @param {MemoizeMap} memoizeMap
 * @returns {Boolean|null} result
*/function s(e,t,n){if(!n||g(e)||g(t))return null;var o=n.get(e);if(o){var i=o.get(t);if("boolean"==typeof i)return i}return null}
/*!
 * Set the result of the equality into the MemoizeMap
 *
 * @param {Mixed} leftHandOperand
 * @param {Mixed} rightHandOperand
 * @param {MemoizeMap} memoizeMap
 * @param {Boolean} result
*/function a(e,t,n,o){if(n&&!g(e)&&!g(t)){var i=n.get(e);i?i.set(t,o):((i=new r).set(t,o),n.set(e,i))}}
/*!
 * Primary Export
 */function c(e,t,n){if(n&&n.comparator)return l(e,t,n);var o=u(e,t);return null!==o?o:l(e,t,n)}function u(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t||!g(e)&&!g(t)&&null}
/*!
 * The main logic of the `deepEqual` function.
 *
 * @param {Mixed} leftHandOperand
 * @param {Mixed} rightHandOperand
 * @param {Object} [options] (optional) Additional options
 * @param {Array} [options.comparator] (optional) Override default algorithm, determining custom equality.
 * @param {Array} [options.memoize] (optional) Provide a custom memoization object which will cache the results of
    complex objects for a speed boost. By passing `false` you can disable memoization, but this will cause circular
    references to blow the stack.
 * @return {Boolean} equal match
*/function l(e,t,n){(n=n||{}).memoize=!1!==n.memoize&&(n.memoize||new r);var i=n&&n.comparator,l=s(e,t,n.memoize);if(null!==l)return l;var g=s(t,e,n.memoize);if(null!==g)return g;if(i){var b=i(e,t);if(!1===b||!0===b)return a(e,t,n.memoize,b),b;var v=u(e,t);if(null!==v)return v}var m=o(e);if(m!==o(t))return a(e,t,n.memoize,!1),!1;a(e,t,n.memoize,!0);var w=function(e,t,n,o){switch(n){case"String":case"Number":case"Boolean":case"Date":return c(e.valueOf(),t.valueOf());case"Promise":case"Symbol":case"function":case"WeakMap":case"WeakSet":case"Error":return e===t;case"Arguments":case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":case"Array":return p(e,t,o);case"RegExp":
/*!
 * Compare two Regular Expressions for equality.
 *
 * @param {RegExp} leftHandOperand
 * @param {RegExp} rightHandOperand
 * @return {Boolean} result
 */
return function(e,t){return e.toString()===t.toString()}
/*!
 * Compare two Sets/Maps for equality. Faster than other equality functions.
 *
 * @param {Set} leftHandOperand
 * @param {Set} rightHandOperand
 * @param {Object} [options] (Optional)
 * @return {Boolean} result
 */(e,t);case"Generator":
/*!
 * Simple equality for generator objects such as those returned by generator functions.
 *
 * @param {Iterable} leftHandOperand
 * @param {Iterable} rightHandOperand
 * @param {Object} [options] (Optional)
 * @return {Boolean} result
 */
return function(e,t,n){return p(d(e),d(t),n)}
/*!
 * Determine if the given object has an @@iterator function.
 *
 * @param {Object} target
 * @return {Boolean} `true` if the object has an @@iterator function.
 */(e,t,o);case"DataView":return p(new Uint8Array(e.buffer),new Uint8Array(t.buffer),o);case"ArrayBuffer":return p(new Uint8Array(e),new Uint8Array(t),o);case"Set":case"Map":return h(e,t,o);default:
/*!
 * Recursively check the equality of two Objects. Once basic sameness has been established it will defer to `deepEqual`
 * for each enumerable key in the object.
 *
 * @param {Mixed} leftHandOperand
 * @param {Mixed} rightHandOperand
 * @param {Object} [options] (Optional)
 * @return {Boolean} result
 */
return function(e,t,n){var o=y(e),i=y(t);if(o.length&&o.length===i.length)return o.sort(),i.sort(),!1!==p(o,i)&&
/*!
 * Determines if two objects have matching values, given a set of keys. Defers to deepEqual for the equality check of
 * each key. If any value of the given key is not equal, the function will return false (early).
 *
 * @param {Mixed} leftHandOperand
 * @param {Mixed} rightHandOperand
 * @param {Array} keys An array of keys to compare the values of leftHandOperand and rightHandOperand against
 * @param {Object} [options] (Optional)
 * @return {Boolean} result
 */
function(e,t,n,o){var i=n.length;if(0===i)return!0;for(var r=0;r<i;r+=1)if(!1===c(e[n[r]],t[n[r]],o))return!1;return!0}(e,t,o,n);var r=f(e),s=f(t);if(r.length&&r.length===s.length)return r.sort(),s.sort(),p(r,s,n);if(0===o.length&&0===r.length&&0===i.length&&0===s.length)return!0;return!1}
/*!
 * Returns true if the argument is a primitive.
 *
 * This intentionally returns true for all objects that can be compared by reference,
 * including functions and symbols.
 *
 * @param {Mixed} value
 * @return {Boolean} result
 */(e,t,o)}}(e,t,m,n);return a(e,t,n.memoize,w),w}function h(e,t,n){if(e.size!==t.size)return!1;if(0===e.size)return!0;var o=[],i=[];return e.forEach(function(e,t){o.push([e,t])}),t.forEach(function(e,t){i.push([e,t])}),p(o.sort(),i.sort(),n)}
/*!
 * Simple equality for flat iterable objects such as Arrays, TypedArrays or Node.js buffers.
 *
 * @param {Iterable} leftHandOperand
 * @param {Iterable} rightHandOperand
 * @param {Object} [options] (Optional)
 * @return {Boolean} result
 */function p(e,t,n){var o=e.length;if(o!==t.length)return!1;if(0===o)return!0;for(var i=-1;++i<o;)if(!1===c(e[i],t[i],n))return!1;return!0}
/*!
 * Gets all iterator entries from the given Object. If the Object has no @@iterator function, returns an empty array.
 * This will consume the iterator - which could have side effects depending on the @@iterator implementation.
 *
 * @param {Object} target
 * @returns {Array} an array of entries from the @@iterator function
 */
function f(e){if(function(e){return"undefined"!=typeof Symbol&&"object"==typeof e&&void 0!==Symbol.iterator&&"function"==typeof e[Symbol.iterator]}(e))try{return d(e[Symbol.iterator]())}catch(e){return[]}return[]}
/*!
 * Gets all entries from a Generator. This will consume the generator - which could have side effects.
 *
 * @param {Generator} target
 * @returns {Array} an array of entries from the Generator.
 */function d(e){for(var t=e.next(),n=[t.value];!1===t.done;)t=e.next(),n.push(t.value);return n}
/*!
 * Gets all own and inherited enumerable keys from a target.
 *
 * @param {Object} target
 * @returns {Array} an array of own and inherited enumerable keys from the target.
 */function y(e){var t=[];for(var n in e)t.push(n);return t}function g(e){return null===e||"object"!=typeof e}e.exports=c,e.exports.MemoizeMap=r},function(e,t,n){
/*!
 * Chai - addProperty utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
var o=n(2),i=n(1),r=n(5),s=n(3);e.exports=function(e,t,n){n=void 0===n?function(){}:n,Object.defineProperty(e,t,{get:function e(){r()||i(this,"lockSsfi")||i(this,"ssfi",e);var t=n.call(this);if(void 0!==t)return t;var a=new o.Assertion;return s(this,a),a},configurable:!0})}},function(e,t,n){
/*!
 * Chai - addMethod utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
var o=n(6),i=n(2),r=n(1),s=n(7),a=n(3);e.exports=function(e,t,n){var c=function(){r(this,"lockSsfi")||r(this,"ssfi",c);var e=n.apply(this,arguments);if(void 0!==e)return e;var t=new i.Assertion;return a(this,t),t};o(c,t,!1),e[t]=s(c,t)}},function(e,t,n){
/*!
 * Chai - overwriteProperty utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
var o=n(2),i=n(1),r=n(5),s=n(3);e.exports=function(e,t,n){var a=Object.getOwnPropertyDescriptor(e,t),c=function(){};a&&"function"==typeof a.get&&(c=a.get),Object.defineProperty(e,t,{get:function e(){r()||i(this,"lockSsfi")||i(this,"ssfi",e);var t=i(this,"lockSsfi");i(this,"lockSsfi",!0);var a=n(c).call(this);if(i(this,"lockSsfi",t),void 0!==a)return a;var u=new o.Assertion;return s(this,u),u},configurable:!0})}},function(e,t,n){
/*!
 * Chai - overwriteMethod utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
var o=n(6),i=n(2),r=n(1),s=n(7),a=n(3);e.exports=function(e,t,n){var c=e[t],u=function(){throw new Error(t+" is not a function")};c&&"function"==typeof c&&(u=c);var l=function(){r(this,"lockSsfi")||r(this,"ssfi",l);var e=r(this,"lockSsfi");r(this,"lockSsfi",!0);var t=n(u).apply(this,arguments);if(r(this,"lockSsfi",e),void 0!==t)return t;var o=new i.Assertion;return a(this,o),o};o(l,t,!1),e[t]=s(l,t)}},function(e,t,n){
/*!
 * Chai - addChainingMethod utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
/*!
 * Module dependencies
 */
var o=n(6),i=n(2),r=n(1),s=n(7),a=n(3),c="function"==typeof Object.setPrototypeOf,u=function(){},l=Object.getOwnPropertyNames(u).filter(function(e){var t=Object.getOwnPropertyDescriptor(u,e);return"object"!=typeof t||!t.configurable}),h=Function.prototype.call,p=Function.prototype.apply;e.exports=function(e,t,n,u){"function"!=typeof u&&(u=function(){});var f={method:n,chainingBehavior:u};e.__methods||(e.__methods={}),e.__methods[t]=f,Object.defineProperty(e,t,{get:function(){f.chainingBehavior.call(this);var n=function(){r(this,"lockSsfi")||r(this,"ssfi",n);var e=f.method.apply(this,arguments);if(void 0!==e)return e;var t=new i.Assertion;return a(this,t),t};if(o(n,t,!0),c){var u=Object.create(this);u.call=h,u.apply=p,Object.setPrototypeOf(n,u)}else{Object.getOwnPropertyNames(e).forEach(function(t){if(-1===l.indexOf(t)){var o=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(n,t,o)}})}return a(this,n),s(n)},configurable:!0})}},function(e,t,n){
/*!
 * Chai - overwriteChainableMethod utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
var o=n(2),i=n(3);e.exports=function(e,t,n,r){var s=e.__methods[t],a=s.chainingBehavior;s.chainingBehavior=function(){var e=r(a).call(this);if(void 0!==e)return e;var t=new o.Assertion;return i(this,t),t};var c=s.method;s.method=function(){var e=n(c).apply(this,arguments);if(void 0!==e)return e;var t=new o.Assertion;return i(this,t),t}}},function(e,t,n){
/*!
 * Chai - compareByInspect utility
 * Copyright(c) 2011-2016 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
/*!
 * Module dependencies
 */
var o=n(9);e.exports=function(e,t){return o(e)<o(t)?-1:1}},function(e,t,n){
/*!
 * Chai - getOwnEnumerableProperties utility
 * Copyright(c) 2011-2016 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
/*!
 * Module dependencies
 */
var o=n(15);e.exports=function(e){return Object.keys(e).concat(o(e))}},function(e,t,n){"use strict";var o=/\s*function(?:\s|\s*\/\*[^(?:*\/)]+\*\/\s*)*([^\(\/]+)/;function i(e){var t="";if(void 0===e.name){var n=String(e).match(o);n&&(t=n[1])}else t=e.name;return t}e.exports={compatibleInstance:function(e,t){return t instanceof Error&&e===t},compatibleConstructor:function(e,t){return t instanceof Error?e.constructor===t.constructor||e instanceof t.constructor:(t.prototype instanceof Error||t===Error)&&(e.constructor===t||e instanceof t)},compatibleMessage:function(e,t){var n="string"==typeof e?e:e.message;return t instanceof RegExp?t.test(n):"string"==typeof t&&-1!==n.indexOf(t)},getMessage:function(e){var t="";return e&&e.message?t=e.message:"string"==typeof e&&(t=e),t},getConstructorName:function(e){var t=e;return e instanceof Error?t=i(e.constructor):"function"==typeof e&&(t=i(e).trim()||i(new e)),t}}},function(e,t){e.exports=Number.isNaN||
/*!
 * Chai - isNaN utility
 * Copyright(c) 2012-2015 Sakthipriyan Vairamani <thechargingvolcano@gmail.com>
 * MIT Licensed
 */
function(e){return e!=e}},function(e,t,n){
/*!
 * chai
 * http://chaijs.com
 * Copyright(c) 2011-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
var o=n(4);e.exports=function(e,t){
/*!
   * Module dependencies.
   */
var n=e.AssertionError,i=t.flag;
/*!
   * Module export.
   */
/*!
   * Assertion Constructor
   *
   * Creates object for chaining.
   *
   * `Assertion` objects contain metadata in the form of flags. Three flags can
   * be assigned during instantiation by passing arguments to this constructor:
   *
   * - `object`: This flag contains the target of the assertion. For example, in
   *   the assertion `expect(numKittens).to.equal(7);`, the `object` flag will
   *   contain `numKittens` so that the `equal` assertion can reference it when
   *   needed.
   *
   * - `message`: This flag contains an optional custom error message to be
   *   prepended to the error message that's generated by the assertion when it
   *   fails.
   *
   * - `ssfi`: This flag stands for "start stack function indicator". It
   *   contains a function reference that serves as the starting point for
   *   removing frames from the stack trace of the error that's created by the
   *   assertion when it fails. The goal is to provide a cleaner stack trace to
   *   end users by removing Chai's internal functions. Note that it only works
   *   in environments that support `Error.captureStackTrace`, and only when
   *   `Chai.config.includeStack` hasn't been set to `false`.
   *
   * - `lockSsfi`: This flag controls whether or not the given `ssfi` flag
   *   should retain its current value, even as assertions are chained off of
   *   this object. This is usually set to `true` when creating a new assertion
   *   from within another assertion. It's also temporarily set to `true` before
   *   an overwritten assertion gets called by the overwriting assertion.
   *
   * @param {Mixed} obj target of the assertion
   * @param {String} msg (optional) custom error message
   * @param {Function} ssfi (optional) starting point for removing stack frames
   * @param {Boolean} lockSsfi (optional) whether or not the ssfi flag is locked
   * @api private
   */
function r(e,n,o,s){return i(this,"ssfi",o||r),i(this,"lockSsfi",s),i(this,"object",e),i(this,"message",n),t.proxify(this)}e.Assertion=r,Object.defineProperty(r,"includeStack",{get:function(){return console.warn("Assertion.includeStack is deprecated, use chai.config.includeStack instead."),o.includeStack},set:function(e){console.warn("Assertion.includeStack is deprecated, use chai.config.includeStack instead."),o.includeStack=e}}),Object.defineProperty(r,"showDiff",{get:function(){return console.warn("Assertion.showDiff is deprecated, use chai.config.showDiff instead."),o.showDiff},set:function(e){console.warn("Assertion.showDiff is deprecated, use chai.config.showDiff instead."),o.showDiff=e}}),r.addProperty=function(e,n){t.addProperty(this.prototype,e,n)},r.addMethod=function(e,n){t.addMethod(this.prototype,e,n)},r.addChainableMethod=function(e,n,o){t.addChainableMethod(this.prototype,e,n,o)},r.overwriteProperty=function(e,n){t.overwriteProperty(this.prototype,e,n)},r.overwriteMethod=function(e,n){t.overwriteMethod(this.prototype,e,n)},r.overwriteChainableMethod=function(e,n,o){t.overwriteChainableMethod(this.prototype,e,n,o)},r.prototype.assert=function(e,r,s,a,c,u){var l=t.test(this,arguments);if(!1!==u&&(u=!0),void 0===a&&void 0===c&&(u=!1),!0!==o.showDiff&&(u=!1),!l){r=t.getMessage(this,arguments);var h=t.getActual(this,arguments);throw new n(r,{actual:h,expected:a,showDiff:u},o.includeStack?this.assert:i(this,"ssfi"))}},
/*!
   * ### ._obj
   *
   * Quick reference to stored `actual` value for plugin developers.
   *
   * @api private
   */
Object.defineProperty(r.prototype,"_obj",{get:function(){return i(this,"object")},set:function(e){i(this,"object",e)}})}},function(e,t){
/*!
 * chai
 * http://chaijs.com
 * Copyright(c) 2011-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
e.exports=function(e,t){var n=e.Assertion,o=e.AssertionError,i=t.flag;function r(e,n){n&&i(this,"message",n),e=e.toLowerCase();var o=i(this,"object"),r=~["a","e","i","o","u"].indexOf(e.charAt(0))?"an ":"a ";this.assert(e===t.type(o).toLowerCase(),"expected #{this} to be "+r+e,"expected #{this} not to be "+r+e)}function s(e,n){return t.isNaN(e)&&t.isNaN(n)||e===n}function a(){i(this,"contains",!0)}function c(e,r){r&&i(this,"message",r);var a=i(this,"object"),c=t.type(a).toLowerCase(),u=i(this,"message"),l=i(this,"negate"),h=i(this,"ssfi"),p=i(this,"deep"),f=p?"deep ":"";u=u?u+": ":"";var d=!1;switch(c){case"string":d=-1!==a.indexOf(e);break;case"weakset":if(p)throw new o(u+"unable to use .deep.include with WeakSet",void 0,h);d=a.has(e);break;case"map":var y=p?t.eql:s;a.forEach(function(t){d=d||y(t,e)});break;case"set":p?a.forEach(function(n){d=d||t.eql(n,e)}):d=a.has(e);break;case"array":d=p?a.some(function(n){return t.eql(n,e)}):-1!==a.indexOf(e);break;default:if(e!==Object(e))throw new o(u+"object tested must be an array, a map, an object, a set, a string, or a weakset, but "+c+" given",void 0,h);var g=Object.keys(e),b=null,v=0;if(g.forEach(function(r){var s=new n(a);if(t.transferFlags(this,s,!0),i(s,"lockSsfi",!0),l&&1!==g.length)try{s.property(r,e[r])}catch(e){if(!t.checkError.compatibleConstructor(e,o))throw e;null===b&&(b=e),v++}else s.property(r,e[r])},this),l&&g.length>1&&v===g.length)throw b;return}this.assert(d,"expected #{this} to "+f+"include "+t.inspect(e),"expected #{this} to not "+f+"include "+t.inspect(e))}function u(){var e=i(this,"object"),n=t.type(e);this.assert("Arguments"===n,"expected #{this} to be arguments but got "+n,"expected #{this} to not be arguments")}function l(e,t){t&&i(this,"message",t);var n=i(this,"object");if(i(this,"deep")){var o=i(this,"lockSsfi");i(this,"lockSsfi",!0),this.eql(e),i(this,"lockSsfi",o)}else this.assert(e===n,"expected #{this} to equal #{exp}","expected #{this} to not equal #{exp}",e,this._obj,!0)}function h(e,n){n&&i(this,"message",n),this.assert(t.eql(e,i(this,"object")),"expected #{this} to deeply equal #{exp}","expected #{this} to not deeply equal #{exp}",e,this._obj,!0)}function p(e,r){r&&i(this,"message",r);var s,a=i(this,"object"),c=i(this,"doLength"),u=i(this,"message"),l=u?u+": ":"",h=i(this,"ssfi"),p=t.type(a).toLowerCase(),f=t.type(e).toLowerCase(),d=!0;if(c&&"map"!==p&&"set"!==p&&new n(a,u,h,!0).to.have.property("length"),c||"date"!==p||"date"===f)if("number"===f||!c&&"number"!==p)if(c||"date"===p||"number"===p)d=!1;else{s=l+"expected "+("string"===p?"'"+a+"'":a)+" to be a number or a date"}else s=l+"the argument to above must be a number";else s=l+"the argument to above must be a date";if(d)throw new o(s,void 0,h);if(c){var y,g="length";"map"===p||"set"===p?(g="size",y=a.size):y=a.length,this.assert(y>e,"expected #{this} to have a "+g+" above #{exp} but got #{act}","expected #{this} to not have a "+g+" above #{exp}",e,y)}else this.assert(a>e,"expected #{this} to be above #{exp}","expected #{this} to be at most #{exp}",e)}function f(e,r){r&&i(this,"message",r);var s,a=i(this,"object"),c=i(this,"doLength"),u=i(this,"message"),l=u?u+": ":"",h=i(this,"ssfi"),p=t.type(a).toLowerCase(),f=t.type(e).toLowerCase(),d=!0;if(c&&"map"!==p&&"set"!==p&&new n(a,u,h,!0).to.have.property("length"),c||"date"!==p||"date"===f)if("number"===f||!c&&"number"!==p)if(c||"date"===p||"number"===p)d=!1;else{s=l+"expected "+("string"===p?"'"+a+"'":a)+" to be a number or a date"}else s=l+"the argument to least must be a number";else s=l+"the argument to least must be a date";if(d)throw new o(s,void 0,h);if(c){var y,g="length";"map"===p||"set"===p?(g="size",y=a.size):y=a.length,this.assert(y>=e,"expected #{this} to have a "+g+" at least #{exp} but got #{act}","expected #{this} to have a "+g+" below #{exp}",e,y)}else this.assert(a>=e,"expected #{this} to be at least #{exp}","expected #{this} to be below #{exp}",e)}function d(e,r){r&&i(this,"message",r);var s,a=i(this,"object"),c=i(this,"doLength"),u=i(this,"message"),l=u?u+": ":"",h=i(this,"ssfi"),p=t.type(a).toLowerCase(),f=t.type(e).toLowerCase(),d=!0;if(c&&"map"!==p&&"set"!==p&&new n(a,u,h,!0).to.have.property("length"),c||"date"!==p||"date"===f)if("number"===f||!c&&"number"!==p)if(c||"date"===p||"number"===p)d=!1;else{s=l+"expected "+("string"===p?"'"+a+"'":a)+" to be a number or a date"}else s=l+"the argument to below must be a number";else s=l+"the argument to below must be a date";if(d)throw new o(s,void 0,h);if(c){var y,g="length";"map"===p||"set"===p?(g="size",y=a.size):y=a.length,this.assert(y<e,"expected #{this} to have a "+g+" below #{exp} but got #{act}","expected #{this} to not have a "+g+" below #{exp}",e,y)}else this.assert(a<e,"expected #{this} to be below #{exp}","expected #{this} to be at least #{exp}",e)}function y(e,r){r&&i(this,"message",r);var s,a=i(this,"object"),c=i(this,"doLength"),u=i(this,"message"),l=u?u+": ":"",h=i(this,"ssfi"),p=t.type(a).toLowerCase(),f=t.type(e).toLowerCase(),d=!0;if(c&&"map"!==p&&"set"!==p&&new n(a,u,h,!0).to.have.property("length"),c||"date"!==p||"date"===f)if("number"===f||!c&&"number"!==p)if(c||"date"===p||"number"===p)d=!1;else{s=l+"expected "+("string"===p?"'"+a+"'":a)+" to be a number or a date"}else s=l+"the argument to most must be a number";else s=l+"the argument to most must be a date";if(d)throw new o(s,void 0,h);if(c){var y,g="length";"map"===p||"set"===p?(g="size",y=a.size):y=a.length,this.assert(y<=e,"expected #{this} to have a "+g+" at most #{exp} but got #{act}","expected #{this} to have a "+g+" above #{exp}",e,y)}else this.assert(a<=e,"expected #{this} to be at most #{exp}","expected #{this} to be above #{exp}",e)}function g(e,n){n&&i(this,"message",n);var r=i(this,"object"),s=i(this,"ssfi"),a=i(this,"message");try{var c=r instanceof e}catch(n){if(n instanceof TypeError)throw new o((a=a?a+": ":"")+"The instanceof assertion needs a constructor but "+t.type(e)+" was given.",void 0,s);throw n}var u=t.getName(e);null===u&&(u="an unnamed constructor"),this.assert(c,"expected #{this} to be an instance of "+u,"expected #{this} to not be an instance of "+u)}function b(e,n,r){r&&i(this,"message",r);var s=i(this,"nested"),a=i(this,"own"),c=i(this,"message"),u=i(this,"object"),l=i(this,"ssfi"),h=typeof e;if(c=c?c+": ":"",s){if("string"!==h)throw new o(c+"the argument to property must be a string when using nested syntax",void 0,l)}else if("string"!==h&&"number"!==h&&"symbol"!==h)throw new o(c+"the argument to property must be a string, number, or symbol",void 0,l);if(s&&a)throw new o(c+'The "nested" and "own" flags cannot be combined.',void 0,l);if(null==u)throw new o(c+"Target cannot be null or undefined.",void 0,l);var p,f=i(this,"deep"),d=i(this,"negate"),y=s?t.getPathInfo(u,e):null,g=s?y.value:u[e],b="";f&&(b+="deep "),a&&(b+="own "),s&&(b+="nested "),b+="property ",p=a?Object.prototype.hasOwnProperty.call(u,e):s?y.exists:t.hasProperty(u,e),d&&1!==arguments.length||this.assert(p,"expected #{this} to have "+b+t.inspect(e),"expected #{this} to not have "+b+t.inspect(e)),arguments.length>1&&this.assert(p&&(f?t.eql(n,g):n===g),"expected #{this} to have "+b+t.inspect(e)+" of #{exp}, but got #{act}","expected #{this} to not have "+b+t.inspect(e)+" of #{act}",n,g),i(this,"object",g)}function v(e,t,n){i(this,"own",!0),b.apply(this,arguments)}function m(e,n,o){"string"==typeof n&&(o=n,n=null),o&&i(this,"message",o);var r=i(this,"object"),s=Object.getOwnPropertyDescriptor(Object(r),e);s&&n?this.assert(t.eql(n,s),"expected the own property descriptor for "+t.inspect(e)+" on #{this} to match "+t.inspect(n)+", got "+t.inspect(s),"expected the own property descriptor for "+t.inspect(e)+" on #{this} to not match "+t.inspect(n),n,s,!0):this.assert(s,"expected #{this} to have an own property descriptor for "+t.inspect(e),"expected #{this} to not have an own property descriptor for "+t.inspect(e)),i(this,"object",s)}function w(){i(this,"doLength",!0)}function _(e,o){o&&i(this,"message",o);var r,s=i(this,"object"),a=t.type(s).toLowerCase(),c=i(this,"message"),u=i(this,"ssfi"),l="length";switch(a){case"map":case"set":l="size",r=s.size;break;default:new n(s,c,u,!0).to.have.property("length"),r=s.length}this.assert(r==e,"expected #{this} to have a "+l+" of #{exp} but got #{act}","expected #{this} to not have a "+l+" of #{act}",e,r)}function k(e,t){t&&i(this,"message",t);var n=i(this,"object");this.assert(e.exec(n),"expected #{this} to match "+e,"expected #{this} not to match "+e)}function x(e){var n,r,s=i(this,"object"),a=t.type(s),c=t.type(e),u=i(this,"ssfi"),l=i(this,"deep"),h="",p=!0,f=i(this,"message"),d=(f=f?f+": ":"")+"when testing keys against an object or an array you must give a single Array|Object|String argument or multiple String arguments";if("Map"===a||"Set"===a)h=l?"deeply ":"",r=[],s.forEach(function(e,t){r.push(t)}),"Array"!==c&&(e=Array.prototype.slice.call(arguments));else{switch(r=t.getOwnEnumerableProperties(s),c){case"Array":if(arguments.length>1)throw new o(d,void 0,u);break;case"Object":if(arguments.length>1)throw new o(d,void 0,u);e=Object.keys(e);break;default:e=Array.prototype.slice.call(arguments)}e=e.map(function(e){return"symbol"==typeof e?e:String(e)})}if(!e.length)throw new o(f+"keys required",void 0,u);var y=e.length,g=i(this,"any"),b=i(this,"all"),v=e;if(g||b||(b=!0),g&&(p=v.some(function(e){return r.some(function(n){return l?t.eql(e,n):e===n})})),b&&(p=v.every(function(e){return r.some(function(n){return l?t.eql(e,n):e===n})}),i(this,"contains")||(p=p&&e.length==r.length)),y>1){var m=(e=e.map(function(e){return t.inspect(e)})).pop();b&&(n=e.join(", ")+", and "+m),g&&(n=e.join(", ")+", or "+m)}else n=t.inspect(e[0]);n=(y>1?"keys ":"key ")+n,n=(i(this,"contains")?"contain ":"have ")+n,this.assert(p,"expected #{this} to "+h+n,"expected #{this} to not "+h+n,v.slice(0).sort(t.compareByInspect),r.sort(t.compareByInspect),!0)}function S(e,o,r){r&&i(this,"message",r);var s,a=i(this,"object"),c=i(this,"ssfi"),u=i(this,"message"),l=i(this,"negate")||!1;new n(a,u,c,!0).is.a("function"),(e instanceof RegExp||"string"==typeof e)&&(o=e,e=null);try{a()}catch(e){s=e}var h=void 0===e&&void 0===o,p=Boolean(e&&o),f=!1,d=!1;if(h||!h&&!l){var y="an error";e instanceof Error?y="#{exp}":e&&(y=t.checkError.getConstructorName(e)),this.assert(s,"expected #{this} to throw "+y,"expected #{this} to not throw an error but #{act} was thrown",e&&e.toString(),s instanceof Error?s.toString():"string"==typeof s?s:s&&t.checkError.getConstructorName(s))}if(e&&s){if(e instanceof Error)t.checkError.compatibleInstance(s,e)===l&&(p&&l?f=!0:this.assert(l,"expected #{this} to throw #{exp} but #{act} was thrown","expected #{this} to not throw #{exp}"+(s&&!l?" but #{act} was thrown":""),e.toString(),s.toString()));t.checkError.compatibleConstructor(s,e)===l&&(p&&l?f=!0:this.assert(l,"expected #{this} to throw #{exp} but #{act} was thrown","expected #{this} to not throw #{exp}"+(s?" but #{act} was thrown":""),e instanceof Error?e.toString():e&&t.checkError.getConstructorName(e),s instanceof Error?s.toString():s&&t.checkError.getConstructorName(s)))}if(s&&null!=o){var g="including";o instanceof RegExp&&(g="matching"),t.checkError.compatibleMessage(s,o)===l&&(p&&l?d=!0:this.assert(l,"expected #{this} to throw error "+g+" #{exp} but got #{act}","expected #{this} to throw error not "+g+" #{exp}",o,t.checkError.getMessage(s)))}f&&d&&this.assert(l,"expected #{this} to throw #{exp} but #{act} was thrown","expected #{this} to not throw #{exp}"+(s?" but #{act} was thrown":""),e instanceof Error?e.toString():e&&t.checkError.getConstructorName(e),s instanceof Error?s.toString():s&&t.checkError.getConstructorName(s)),i(this,"object",s)}function O(e,n){n&&i(this,"message",n);var o=i(this,"object"),r=i(this,"itself"),s="function"!=typeof o||r?o[e]:o.prototype[e];this.assert("function"==typeof s,"expected #{this} to respond to "+t.inspect(e),"expected #{this} to not respond to "+t.inspect(e))}function M(e,n){n&&i(this,"message",n);var o=e(i(this,"object"));this.assert(o,"expected #{this} to satisfy "+t.objDisplay(e),"expected #{this} to not satisfy"+t.objDisplay(e),!i(this,"negate"),o)}function P(e,t,r){r&&i(this,"message",r);var s=i(this,"object"),a=i(this,"message"),c=i(this,"ssfi");if(new n(s,a,c,!0).is.a("number"),"number"!=typeof e||"number"!=typeof t)throw new o((a=a?a+": ":"")+"the arguments to closeTo or approximately must be numbers",void 0,c);this.assert(Math.abs(s-e)<=t,"expected #{this} to be close to "+e+" +/- "+t,"expected #{this} not to be close to "+e+" +/- "+t)}function C(e,t,o){o&&i(this,"message",o);var r,s=i(this,"object"),a=i(this,"message"),c=i(this,"ssfi");new n(s,a,c,!0).is.a("function"),t?(new n(e,a,c,!0).to.have.property(t),r=e[t]):(new n(e,a,c,!0).is.a("function"),r=e()),s();var u=null==t?e():e[t],l=null==t?r:"."+t;i(this,"deltaMsgObj",l),i(this,"initialDeltaValue",r),i(this,"finalDeltaValue",u),i(this,"deltaBehavior","change"),i(this,"realDelta",u!==r),this.assert(r!==u,"expected "+l+" to change","expected "+l+" to not change")}function E(e,t,o){o&&i(this,"message",o);var r,s=i(this,"object"),a=i(this,"message"),c=i(this,"ssfi");new n(s,a,c,!0).is.a("function"),t?(new n(e,a,c,!0).to.have.property(t),r=e[t]):(new n(e,a,c,!0).is.a("function"),r=e()),new n(r,a,c,!0).is.a("number"),s();var u=null==t?e():e[t],l=null==t?r:"."+t;i(this,"deltaMsgObj",l),i(this,"initialDeltaValue",r),i(this,"finalDeltaValue",u),i(this,"deltaBehavior","increase"),i(this,"realDelta",u-r),this.assert(u-r>0,"expected "+l+" to increase","expected "+l+" to not increase")}function j(e,t,o){o&&i(this,"message",o);var r,s=i(this,"object"),a=i(this,"message"),c=i(this,"ssfi");new n(s,a,c,!0).is.a("function"),t?(new n(e,a,c,!0).to.have.property(t),r=e[t]):(new n(e,a,c,!0).is.a("function"),r=e()),new n(r,a,c,!0).is.a("number"),s();var u=null==t?e():e[t],l=null==t?r:"."+t;i(this,"deltaMsgObj",l),i(this,"initialDeltaValue",r),i(this,"finalDeltaValue",u),i(this,"deltaBehavior","decrease"),i(this,"realDelta",r-u),this.assert(u-r<0,"expected "+l+" to decrease","expected "+l+" to not decrease")}["to","be","been","is","and","has","have","with","that","which","at","of","same","but","does","still"].forEach(function(e){n.addProperty(e)}),n.addProperty("not",function(){i(this,"negate",!0)}),n.addProperty("deep",function(){i(this,"deep",!0)}),n.addProperty("nested",function(){i(this,"nested",!0)}),n.addProperty("own",function(){i(this,"own",!0)}),n.addProperty("ordered",function(){i(this,"ordered",!0)}),n.addProperty("any",function(){i(this,"any",!0),i(this,"all",!1)}),n.addProperty("all",function(){i(this,"all",!0),i(this,"any",!1)}),n.addChainableMethod("an",r),n.addChainableMethod("a",r),n.addChainableMethod("include",c,a),n.addChainableMethod("contain",c,a),n.addChainableMethod("contains",c,a),n.addChainableMethod("includes",c,a),n.addProperty("ok",function(){this.assert(i(this,"object"),"expected #{this} to be truthy","expected #{this} to be falsy")}),n.addProperty("true",function(){this.assert(!0===i(this,"object"),"expected #{this} to be true","expected #{this} to be false",!i(this,"negate"))}),n.addProperty("false",function(){this.assert(!1===i(this,"object"),"expected #{this} to be false","expected #{this} to be true",!!i(this,"negate"))}),n.addProperty("null",function(){this.assert(null===i(this,"object"),"expected #{this} to be null","expected #{this} not to be null")}),n.addProperty("undefined",function(){this.assert(void 0===i(this,"object"),"expected #{this} to be undefined","expected #{this} not to be undefined")}),n.addProperty("NaN",function(){this.assert(t.isNaN(i(this,"object")),"expected #{this} to be NaN","expected #{this} not to be NaN")}),n.addProperty("exist",function(){var e=i(this,"object");this.assert(null!=e,"expected #{this} to exist","expected #{this} to not exist")}),n.addProperty("empty",function(){var e,n=i(this,"object"),r=i(this,"ssfi"),s=i(this,"message");switch(s=s?s+": ":"",t.type(n).toLowerCase()){case"array":case"string":e=n.length;break;case"map":case"set":e=n.size;break;case"weakmap":case"weakset":throw new o(s+".empty was passed a weak collection",void 0,r);case"function":var a=s+".empty was passed a function "+t.getName(n);throw new o(a.trim(),void 0,r);default:if(n!==Object(n))throw new o(s+".empty was passed non-string primitive "+t.inspect(n),void 0,r);e=Object.keys(n).length}this.assert(0===e,"expected #{this} to be empty","expected #{this} not to be empty")}),n.addProperty("arguments",u),n.addProperty("Arguments",u),n.addMethod("equal",l),n.addMethod("equals",l),n.addMethod("eq",l),n.addMethod("eql",h),n.addMethod("eqls",h),n.addMethod("above",p),n.addMethod("gt",p),n.addMethod("greaterThan",p),n.addMethod("least",f),n.addMethod("gte",f),n.addMethod("below",d),n.addMethod("lt",d),n.addMethod("lessThan",d),n.addMethod("most",y),n.addMethod("lte",y),n.addMethod("within",function(e,r,s){s&&i(this,"message",s);var a,c=i(this,"object"),u=i(this,"doLength"),l=i(this,"message"),h=l?l+": ":"",p=i(this,"ssfi"),f=t.type(c).toLowerCase(),d=t.type(e).toLowerCase(),y=t.type(r).toLowerCase(),g=!0,b="date"===d&&"date"===y?e.toUTCString()+".."+r.toUTCString():e+".."+r;if(u&&"map"!==f&&"set"!==f&&new n(c,l,p,!0).to.have.property("length"),u||"date"!==f||"date"===d&&"date"===y)if("number"===d&&"number"===y||!u&&"number"!==f)if(u||"date"===f||"number"===f)g=!1;else{a=h+"expected "+("string"===f?"'"+c+"'":c)+" to be a number or a date"}else a=h+"the arguments to within must be numbers";else a=h+"the arguments to within must be dates";if(g)throw new o(a,void 0,p);if(u){var v,m="length";"map"===f||"set"===f?(m="size",v=c.size):v=c.length,this.assert(v>=e&&v<=r,"expected #{this} to have a "+m+" within "+b,"expected #{this} to not have a "+m+" within "+b)}else this.assert(c>=e&&c<=r,"expected #{this} to be within "+b,"expected #{this} to not be within "+b)}),n.addMethod("instanceof",g),n.addMethod("instanceOf",g),n.addMethod("property",b),n.addMethod("ownProperty",v),n.addMethod("haveOwnProperty",v),n.addMethod("ownPropertyDescriptor",m),n.addMethod("haveOwnPropertyDescriptor",m),n.addChainableMethod("length",_,w),n.addChainableMethod("lengthOf",_,w),n.addMethod("match",k),n.addMethod("matches",k),n.addMethod("string",function(e,o){o&&i(this,"message",o);var r=i(this,"object"),s=i(this,"message"),a=i(this,"ssfi");new n(r,s,a,!0).is.a("string"),this.assert(~r.indexOf(e),"expected #{this} to contain "+t.inspect(e),"expected #{this} to not contain "+t.inspect(e))}),n.addMethod("keys",x),n.addMethod("key",x),n.addMethod("throw",S),n.addMethod("throws",S),n.addMethod("Throw",S),n.addMethod("respondTo",O),n.addMethod("respondsTo",O),n.addProperty("itself",function(){i(this,"itself",!0)}),n.addMethod("satisfy",M),n.addMethod("satisfies",M),n.addMethod("closeTo",P),n.addMethod("approximately",P),n.addMethod("members",function(e,o){o&&i(this,"message",o);var r=i(this,"object"),s=i(this,"message"),a=i(this,"ssfi");new n(r,s,a,!0).to.be.an("array"),new n(e,s,a,!0).to.be.an("array");var c,u,l,h=i(this,"contains"),p=i(this,"ordered");h?(u="expected #{this} to be "+(c=p?"an ordered superset":"a superset")+" of #{exp}",l="expected #{this} to not be "+c+" of #{exp}"):(u="expected #{this} to have the same "+(c=p?"ordered members":"members")+" as #{exp}",l="expected #{this} to not have the same "+c+" as #{exp}");var f=i(this,"deep")?t.eql:void 0;this.assert(function(e,t,n,o,i){if(!o){if(e.length!==t.length)return!1;t=t.slice()}return e.every(function(e,r){if(i)return n?n(e,t[r]):e===t[r];if(!n){var s=t.indexOf(e);return-1!==s&&(o||t.splice(s,1),!0)}return t.some(function(i,r){return!!n(e,i)&&(o||t.splice(r,1),!0)})})}(e,r,f,h,p),u,l,e,r,!0)}),n.addMethod("oneOf",function(e,t){t&&i(this,"message",t);var o=i(this,"object"),r=i(this,"message"),s=i(this,"ssfi");new n(e,r,s,!0).to.be.an("array"),this.assert(e.indexOf(o)>-1,"expected #{this} to be one of #{exp}","expected #{this} to not be one of #{exp}",e,o)}),n.addMethod("change",C),n.addMethod("changes",C),n.addMethod("increase",E),n.addMethod("increases",E),n.addMethod("decrease",j),n.addMethod("decreases",j),n.addMethod("by",function(e,t){t&&i(this,"message",t);var n,o=i(this,"deltaMsgObj"),r=i(this,"initialDeltaValue"),s=i(this,"finalDeltaValue"),a=i(this,"deltaBehavior"),c=i(this,"realDelta");n="change"===a?Math.abs(s-r)===Math.abs(e):c===Math.abs(e),this.assert(n,"expected "+o+" to "+a+" by "+e,"expected "+o+" to not "+a+" by "+e)}),n.addProperty("extensible",function(){var e=i(this,"object"),t=e===Object(e)&&Object.isExtensible(e);this.assert(t,"expected #{this} to be extensible","expected #{this} to not be extensible")}),n.addProperty("sealed",function(){var e=i(this,"object"),t=e!==Object(e)||Object.isSealed(e);this.assert(t,"expected #{this} to be sealed","expected #{this} to not be sealed")}),n.addProperty("frozen",function(){var e=i(this,"object"),t=e!==Object(e)||Object.isFrozen(e);this.assert(t,"expected #{this} to be frozen","expected #{this} to not be frozen")}),n.addProperty("finite",function(e){var t=i(this,"object");this.assert("number"==typeof t&&isFinite(t),"expected #{this} to be a finite number","expected #{this} to not be a finite number")})}},function(e,t){
/*!
 * chai
 * Copyright(c) 2011-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
e.exports=function(e,t){e.expect=function(t,n){return new e.Assertion(t,n)},e.expect.fail=function(t,n,o,i){throw arguments.length<2&&(o=t,t=void 0),o=o||"expect.fail()",new e.AssertionError(o,{actual:t,expected:n,operator:i},e.expect.fail)}}},function(e,t){
/*!
 * chai
 * Copyright(c) 2011-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
e.exports=function(e,t){var n=e.Assertion;function o(){Object.defineProperty(Object.prototype,"should",{set:function(e){Object.defineProperty(this,"should",{value:e,enumerable:!0,configurable:!0,writable:!0})},get:function e(){return this instanceof String||this instanceof Number||this instanceof Boolean||"function"==typeof Symbol&&this instanceof Symbol?new n(this.valueOf(),null,e):new n(this,null,e)},configurable:!0});var t={fail:function(n,o,i,r){throw arguments.length<2&&(i=n,n=void 0),i=i||"should.fail()",new e.AssertionError(i,{actual:n,expected:o,operator:r},t.fail)},equal:function(e,t,o){new n(e,o).to.equal(t)},Throw:function(e,t,o,i){new n(e,i).to.Throw(t,o)},exist:function(e,t){new n(e,t).to.exist},not:{}};return t.not.equal=function(e,t,o){new n(e,o).to.not.equal(t)},t.not.Throw=function(e,t,o,i){new n(e,i).to.not.Throw(t,o)},t.not.exist=function(e,t){new n(e,t).to.not.exist},t.throw=t.Throw,t.not.throw=t.not.Throw,t}e.should=o,e.Should=o}},function(e,t){
/*!
 * chai
 * Copyright(c) 2011-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */
e.exports=function(e,t){
/*!
   * Chai dependencies.
   */
var n=e.Assertion,o=t.flag,i=e.assert=function(t,o){new n(null,null,e.assert,!0).assert(t,o,"[ negation message unavailable ]")};
/*!
   * Module export.
   */i.fail=function(t,n,o,r){throw arguments.length<2&&(o=t,t=void 0),o=o||"assert.fail()",new e.AssertionError(o,{actual:t,expected:n,operator:r},i.fail)},i.isOk=function(e,t){new n(e,t,i.isOk,!0).is.ok},i.isNotOk=function(e,t){new n(e,t,i.isNotOk,!0).is.not.ok},i.equal=function(e,t,r){var s=new n(e,r,i.equal,!0);s.assert(t==o(s,"object"),"expected #{this} to equal #{exp}","expected #{this} to not equal #{act}",t,e,!0)},i.notEqual=function(e,t,r){var s=new n(e,r,i.notEqual,!0);s.assert(t!=o(s,"object"),"expected #{this} to not equal #{exp}","expected #{this} to equal #{act}",t,e,!0)},i.strictEqual=function(e,t,o){new n(e,o,i.strictEqual,!0).to.equal(t)},i.notStrictEqual=function(e,t,o){new n(e,o,i.notStrictEqual,!0).to.not.equal(t)},i.deepEqual=i.deepStrictEqual=function(e,t,o){new n(e,o,i.deepEqual,!0).to.eql(t)},i.notDeepEqual=function(e,t,o){new n(e,o,i.notDeepEqual,!0).to.not.eql(t)},i.isAbove=function(e,t,o){new n(e,o,i.isAbove,!0).to.be.above(t)},i.isAtLeast=function(e,t,o){new n(e,o,i.isAtLeast,!0).to.be.least(t)},i.isBelow=function(e,t,o){new n(e,o,i.isBelow,!0).to.be.below(t)},i.isAtMost=function(e,t,o){new n(e,o,i.isAtMost,!0).to.be.most(t)},i.isTrue=function(e,t){new n(e,t,i.isTrue,!0).is.true},i.isNotTrue=function(e,t){new n(e,t,i.isNotTrue,!0).to.not.equal(!0)},i.isFalse=function(e,t){new n(e,t,i.isFalse,!0).is.false},i.isNotFalse=function(e,t){new n(e,t,i.isNotFalse,!0).to.not.equal(!1)},i.isNull=function(e,t){new n(e,t,i.isNull,!0).to.equal(null)},i.isNotNull=function(e,t){new n(e,t,i.isNotNull,!0).to.not.equal(null)},i.isNaN=function(e,t){new n(e,t,i.isNaN,!0).to.be.NaN},i.isNotNaN=function(e,t){new n(e,t,i.isNotNaN,!0).not.to.be.NaN},i.exists=function(e,t){new n(e,t,i.exists,!0).to.exist},i.notExists=function(e,t){new n(e,t,i.notExists,!0).to.not.exist},i.isUndefined=function(e,t){new n(e,t,i.isUndefined,!0).to.equal(void 0)},i.isDefined=function(e,t){new n(e,t,i.isDefined,!0).to.not.equal(void 0)},i.isFunction=function(e,t){new n(e,t,i.isFunction,!0).to.be.a("function")},i.isNotFunction=function(e,t){new n(e,t,i.isNotFunction,!0).to.not.be.a("function")},i.isObject=function(e,t){new n(e,t,i.isObject,!0).to.be.a("object")},i.isNotObject=function(e,t){new n(e,t,i.isNotObject,!0).to.not.be.a("object")},i.isArray=function(e,t){new n(e,t,i.isArray,!0).to.be.an("array")},i.isNotArray=function(e,t){new n(e,t,i.isNotArray,!0).to.not.be.an("array")},i.isString=function(e,t){new n(e,t,i.isString,!0).to.be.a("string")},i.isNotString=function(e,t){new n(e,t,i.isNotString,!0).to.not.be.a("string")},i.isNumber=function(e,t){new n(e,t,i.isNumber,!0).to.be.a("number")},i.isNotNumber=function(e,t){new n(e,t,i.isNotNumber,!0).to.not.be.a("number")},i.isFinite=function(e,t){new n(e,t,i.isFinite,!0).to.be.finite},i.isBoolean=function(e,t){new n(e,t,i.isBoolean,!0).to.be.a("boolean")},i.isNotBoolean=function(e,t){new n(e,t,i.isNotBoolean,!0).to.not.be.a("boolean")},i.typeOf=function(e,t,o){new n(e,o,i.typeOf,!0).to.be.a(t)},i.notTypeOf=function(e,t,o){new n(e,o,i.notTypeOf,!0).to.not.be.a(t)},i.instanceOf=function(e,t,o){new n(e,o,i.instanceOf,!0).to.be.instanceOf(t)},i.notInstanceOf=function(e,t,o){new n(e,o,i.notInstanceOf,!0).to.not.be.instanceOf(t)},i.include=function(e,t,o){new n(e,o,i.include,!0).include(t)},i.notInclude=function(e,t,o){new n(e,o,i.notInclude,!0).not.include(t)},i.deepInclude=function(e,t,o){new n(e,o,i.deepInclude,!0).deep.include(t)},i.notDeepInclude=function(e,t,o){new n(e,o,i.notDeepInclude,!0).not.deep.include(t)},i.nestedInclude=function(e,t,o){new n(e,o,i.nestedInclude,!0).nested.include(t)},i.notNestedInclude=function(e,t,o){new n(e,o,i.notNestedInclude,!0).not.nested.include(t)},i.deepNestedInclude=function(e,t,o){new n(e,o,i.deepNestedInclude,!0).deep.nested.include(t)},i.notDeepNestedInclude=function(e,t,o){new n(e,o,i.notDeepNestedInclude,!0).not.deep.nested.include(t)},i.ownInclude=function(e,t,o){new n(e,o,i.ownInclude,!0).own.include(t)},i.notOwnInclude=function(e,t,o){new n(e,o,i.notOwnInclude,!0).not.own.include(t)},i.deepOwnInclude=function(e,t,o){new n(e,o,i.deepOwnInclude,!0).deep.own.include(t)},i.notDeepOwnInclude=function(e,t,o){new n(e,o,i.notDeepOwnInclude,!0).not.deep.own.include(t)},i.match=function(e,t,o){new n(e,o,i.match,!0).to.match(t)},i.notMatch=function(e,t,o){new n(e,o,i.notMatch,!0).to.not.match(t)},i.property=function(e,t,o){new n(e,o,i.property,!0).to.have.property(t)},i.notProperty=function(e,t,o){new n(e,o,i.notProperty,!0).to.not.have.property(t)},i.propertyVal=function(e,t,o,r){new n(e,r,i.propertyVal,!0).to.have.property(t,o)},i.notPropertyVal=function(e,t,o,r){new n(e,r,i.notPropertyVal,!0).to.not.have.property(t,o)},i.deepPropertyVal=function(e,t,o,r){new n(e,r,i.deepPropertyVal,!0).to.have.deep.property(t,o)},i.notDeepPropertyVal=function(e,t,o,r){new n(e,r,i.notDeepPropertyVal,!0).to.not.have.deep.property(t,o)},i.ownProperty=function(e,t,o){new n(e,o,i.ownProperty,!0).to.have.own.property(t)},i.notOwnProperty=function(e,t,o){new n(e,o,i.notOwnProperty,!0).to.not.have.own.property(t)},i.ownPropertyVal=function(e,t,o,r){new n(e,r,i.ownPropertyVal,!0).to.have.own.property(t,o)},i.notOwnPropertyVal=function(e,t,o,r){new n(e,r,i.notOwnPropertyVal,!0).to.not.have.own.property(t,o)},i.deepOwnPropertyVal=function(e,t,o,r){new n(e,r,i.deepOwnPropertyVal,!0).to.have.deep.own.property(t,o)},i.notDeepOwnPropertyVal=function(e,t,o,r){new n(e,r,i.notDeepOwnPropertyVal,!0).to.not.have.deep.own.property(t,o)},i.nestedProperty=function(e,t,o){new n(e,o,i.nestedProperty,!0).to.have.nested.property(t)},i.notNestedProperty=function(e,t,o){new n(e,o,i.notNestedProperty,!0).to.not.have.nested.property(t)},i.nestedPropertyVal=function(e,t,o,r){new n(e,r,i.nestedPropertyVal,!0).to.have.nested.property(t,o)},i.notNestedPropertyVal=function(e,t,o,r){new n(e,r,i.notNestedPropertyVal,!0).to.not.have.nested.property(t,o)},i.deepNestedPropertyVal=function(e,t,o,r){new n(e,r,i.deepNestedPropertyVal,!0).to.have.deep.nested.property(t,o)},i.notDeepNestedPropertyVal=function(e,t,o,r){new n(e,r,i.notDeepNestedPropertyVal,!0).to.not.have.deep.nested.property(t,o)},i.lengthOf=function(e,t,o){new n(e,o,i.lengthOf,!0).to.have.lengthOf(t)},i.hasAnyKeys=function(e,t,o){new n(e,o,i.hasAnyKeys,!0).to.have.any.keys(t)},i.hasAllKeys=function(e,t,o){new n(e,o,i.hasAllKeys,!0).to.have.all.keys(t)},i.containsAllKeys=function(e,t,o){new n(e,o,i.containsAllKeys,!0).to.contain.all.keys(t)},i.doesNotHaveAnyKeys=function(e,t,o){new n(e,o,i.doesNotHaveAnyKeys,!0).to.not.have.any.keys(t)},i.doesNotHaveAllKeys=function(e,t,o){new n(e,o,i.doesNotHaveAllKeys,!0).to.not.have.all.keys(t)},i.hasAnyDeepKeys=function(e,t,o){new n(e,o,i.hasAnyDeepKeys,!0).to.have.any.deep.keys(t)},i.hasAllDeepKeys=function(e,t,o){new n(e,o,i.hasAllDeepKeys,!0).to.have.all.deep.keys(t)},i.containsAllDeepKeys=function(e,t,o){new n(e,o,i.containsAllDeepKeys,!0).to.contain.all.deep.keys(t)},i.doesNotHaveAnyDeepKeys=function(e,t,o){new n(e,o,i.doesNotHaveAnyDeepKeys,!0).to.not.have.any.deep.keys(t)},i.doesNotHaveAllDeepKeys=function(e,t,o){new n(e,o,i.doesNotHaveAllDeepKeys,!0).to.not.have.all.deep.keys(t)},i.throws=function(e,t,r,s){("string"==typeof t||t instanceof RegExp)&&(r=t,t=null);var a=new n(e,s,i.throws,!0).to.throw(t,r);return o(a,"object")},i.doesNotThrow=function(e,t,o,r){("string"==typeof t||t instanceof RegExp)&&(o=t,t=null),new n(e,r,i.doesNotThrow,!0).to.not.throw(t,o)},i.operator=function(r,s,a,c){var u;switch(s){case"==":u=r==a;break;case"===":u=r===a;break;case">":u=r>a;break;case">=":u=r>=a;break;case"<":u=r<a;break;case"<=":u=r<=a;break;case"!=":u=r!=a;break;case"!==":u=r!==a;break;default:throw c=c?c+": ":c,new e.AssertionError(c+'Invalid operator "'+s+'"',void 0,i.operator)}var l=new n(u,c,i.operator,!0);l.assert(!0===o(l,"object"),"expected "+t.inspect(r)+" to be "+s+" "+t.inspect(a),"expected "+t.inspect(r)+" to not be "+s+" "+t.inspect(a))},i.closeTo=function(e,t,o,r){new n(e,r,i.closeTo,!0).to.be.closeTo(t,o)},i.approximately=function(e,t,o,r){new n(e,r,i.approximately,!0).to.be.approximately(t,o)},i.sameMembers=function(e,t,o){new n(e,o,i.sameMembers,!0).to.have.same.members(t)},i.notSameMembers=function(e,t,o){new n(e,o,i.notSameMembers,!0).to.not.have.same.members(t)},i.sameDeepMembers=function(e,t,o){new n(e,o,i.sameDeepMembers,!0).to.have.same.deep.members(t)},i.notSameDeepMembers=function(e,t,o){new n(e,o,i.notSameDeepMembers,!0).to.not.have.same.deep.members(t)},i.sameOrderedMembers=function(e,t,o){new n(e,o,i.sameOrderedMembers,!0).to.have.same.ordered.members(t)},i.notSameOrderedMembers=function(e,t,o){new n(e,o,i.notSameOrderedMembers,!0).to.not.have.same.ordered.members(t)},i.sameDeepOrderedMembers=function(e,t,o){new n(e,o,i.sameDeepOrderedMembers,!0).to.have.same.deep.ordered.members(t)},i.notSameDeepOrderedMembers=function(e,t,o){new n(e,o,i.notSameDeepOrderedMembers,!0).to.not.have.same.deep.ordered.members(t)},i.includeMembers=function(e,t,o){new n(e,o,i.includeMembers,!0).to.include.members(t)},i.notIncludeMembers=function(e,t,o){new n(e,o,i.notIncludeMembers,!0).to.not.include.members(t)},i.includeDeepMembers=function(e,t,o){new n(e,o,i.includeDeepMembers,!0).to.include.deep.members(t)},i.notIncludeDeepMembers=function(e,t,o){new n(e,o,i.notIncludeDeepMembers,!0).to.not.include.deep.members(t)},i.includeOrderedMembers=function(e,t,o){new n(e,o,i.includeOrderedMembers,!0).to.include.ordered.members(t)},i.notIncludeOrderedMembers=function(e,t,o){new n(e,o,i.notIncludeOrderedMembers,!0).to.not.include.ordered.members(t)},i.includeDeepOrderedMembers=function(e,t,o){new n(e,o,i.includeDeepOrderedMembers,!0).to.include.deep.ordered.members(t)},i.notIncludeDeepOrderedMembers=function(e,t,o){new n(e,o,i.notIncludeDeepOrderedMembers,!0).to.not.include.deep.ordered.members(t)},i.oneOf=function(e,t,o){new n(e,o,i.oneOf,!0).to.be.oneOf(t)},i.changes=function(e,t,o,r){3===arguments.length&&"function"==typeof t&&(r=o,o=null),new n(e,r,i.changes,!0).to.change(t,o)},i.changesBy=function(e,t,o,r,s){if(4===arguments.length&&"function"==typeof t){var a=r;r=o,s=a}else 3===arguments.length&&(r=o,o=null);new n(e,s,i.changesBy,!0).to.change(t,o).by(r)},i.doesNotChange=function(e,t,o,r){return 3===arguments.length&&"function"==typeof t&&(r=o,o=null),new n(e,r,i.doesNotChange,!0).to.not.change(t,o)},i.changesButNotBy=function(e,t,o,r,s){if(4===arguments.length&&"function"==typeof t){var a=r;r=o,s=a}else 3===arguments.length&&(r=o,o=null);new n(e,s,i.changesButNotBy,!0).to.change(t,o).but.not.by(r)},i.increases=function(e,t,o,r){return 3===arguments.length&&"function"==typeof t&&(r=o,o=null),new n(e,r,i.increases,!0).to.increase(t,o)},i.increasesBy=function(e,t,o,r,s){if(4===arguments.length&&"function"==typeof t){var a=r;r=o,s=a}else 3===arguments.length&&(r=o,o=null);new n(e,s,i.increasesBy,!0).to.increase(t,o).by(r)},i.doesNotIncrease=function(e,t,o,r){return 3===arguments.length&&"function"==typeof t&&(r=o,o=null),new n(e,r,i.doesNotIncrease,!0).to.not.increase(t,o)},i.increasesButNotBy=function(e,t,o,r,s){if(4===arguments.length&&"function"==typeof t){var a=r;r=o,s=a}else 3===arguments.length&&(r=o,o=null);new n(e,s,i.increasesButNotBy,!0).to.increase(t,o).but.not.by(r)},i.decreases=function(e,t,o,r){return 3===arguments.length&&"function"==typeof t&&(r=o,o=null),new n(e,r,i.decreases,!0).to.decrease(t,o)},i.decreasesBy=function(e,t,o,r,s){if(4===arguments.length&&"function"==typeof t){var a=r;r=o,s=a}else 3===arguments.length&&(r=o,o=null);new n(e,s,i.decreasesBy,!0).to.decrease(t,o).by(r)},i.doesNotDecrease=function(e,t,o,r){return 3===arguments.length&&"function"==typeof t&&(r=o,o=null),new n(e,r,i.doesNotDecrease,!0).to.not.decrease(t,o)},i.doesNotDecreaseBy=function(e,t,o,r,s){if(4===arguments.length&&"function"==typeof t){var a=r;r=o,s=a}else 3===arguments.length&&(r=o,o=null);return new n(e,s,i.doesNotDecreaseBy,!0).to.not.decrease(t,o).by(r)},i.decreasesButNotBy=function(e,t,o,r,s){if(4===arguments.length&&"function"==typeof t){var a=r;r=o,s=a}else 3===arguments.length&&(r=o,o=null);new n(e,s,i.decreasesButNotBy,!0).to.decrease(t,o).but.not.by(r)}
/*!
   * ### .ifError(object)
   *
   * Asserts if value is not a false value, and throws if it is a true value.
   * This is added to allow for chai to be a drop-in replacement for Node's
   * assert class.
   *
   *     var err = new Error('I am a custom error');
   *     assert.ifError(err); // Rethrows err!
   *
   * @name ifError
   * @param {Object} object
   * @namespace Assert
   * @api public
   */,i.ifError=function(e){if(e)throw e},i.isExtensible=function(e,t){new n(e,t,i.isExtensible,!0).to.be.extensible},i.isNotExtensible=function(e,t){new n(e,t,i.isNotExtensible,!0).to.not.be.extensible},i.isSealed=function(e,t){new n(e,t,i.isSealed,!0).to.be.sealed},i.isNotSealed=function(e,t){new n(e,t,i.isNotSealed,!0).to.not.be.sealed},i.isFrozen=function(e,t){new n(e,t,i.isFrozen,!0).to.be.frozen},i.isNotFrozen=function(e,t){new n(e,t,i.isNotFrozen,!0).to.not.be.frozen},i.isEmpty=function(e,t){new n(e,t,i.isEmpty,!0).to.be.empty},i.isNotEmpty=function(e,t){new n(e,t,i.isNotEmpty,!0).to.not.be.empty},
/*!
   * Aliases.
   */
function e(t,n){return i[n]=i[t],e}("isOk","ok")("isNotOk","notOk")("throws","throw")("throws","Throw")("isExtensible","extensible")("isNotExtensible","notExtensible")("isSealed","sealed")("isNotSealed","notSealed")("isFrozen","frozen")("isNotFrozen","notFrozen")("isEmpty","empty")("isNotEmpty","notEmpty")}},function(e,t,n){"use strict";e.exports=(e=>encodeURIComponent(e).replace(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`))},function(e,t,n){"use strict";var o=new RegExp("%[a-f0-9]{2}","gi"),i=new RegExp("(%[a-f0-9]{2})+","gi");function r(e,t){try{return decodeURIComponent(e.join(""))}catch(e){}if(1===e.length)return e;t=t||1;var n=e.slice(0,t),o=e.slice(t);return Array.prototype.concat.call([],r(n),r(o))}function s(e){try{return decodeURIComponent(e)}catch(i){for(var t=e.match(o),n=1;n<t.length;n++)t=(e=r(t,n).join("")).match(o);return e}}e.exports=function(e){if("string"!=typeof e)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return e=e.replace(/\+/g," "),decodeURIComponent(e)}catch(t){return function(e){for(var t={"%FE%FF":"��","%FF%FE":"��"},n=i.exec(e);n;){try{t[n[0]]=decodeURIComponent(n[0])}catch(e){var o=s(n[0]);o!==n[0]&&(t[n[0]]=o)}n=i.exec(e)}t["%C2"]="�";for(var r=Object.keys(t),a=0;a<r.length;a++){var c=r[a];e=e.replace(new RegExp(c,"g"),t[c])}return e}(e)}}},function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=43},function(e,t,n){"use strict";n.r(t);var o=n(0);function i(e,t){let n=e.get(t);if(void 0!==n)return n;throw new Error(`Key ${t.toString()} not in Map ${e.toString()}`)}function r(e){let t=e.shift();if(void 0!==t)return t;throw new Error(`Shift returned undefined from Array ${e.toString()}`)}class s{constructor(e,t,n){this.frame=e,this.state=t,this.inputs=n}isPlayerInputPredicted(e){return i(this.inputs,e).isPrediction}anyInputPredicted(){for(const[e,{isPrediction:t}]of this.inputs.entries())if(t)return!0;return!1}allInputsSynced(){return!this.anyInputPredicted()}tick(e){let t=new Map;for(const[n,{input:o}]of e.entries())t.set(n,o);return new s(this.frame+1,this.state.tick(t),e)}}class a{constructor(e,t,n,i,r,a){this.isServer=e,this.history=[new s(0,t,n)],this.maxHistorySize=i,this.broadcastInput=r,this.future=new Map;for(let e of n.keys())this.future.set(e,[]);e&&(o.assert.exists(a),this.broadcastState=a)}onStateSync(e,t){for(o.assert.isFalse(this.isServer,"Only clients recieve state syncs.");this.history.length>0&&(o.assert.isTrue(this.history[0].allInputsSynced()),this.history[0].frame<e);)r(this.history);o.assert.equal(this.history[0].frame,e),this.history[0].state=t;for(let e=1;e<this.history.length;++e){let t=this.history[e],n=this.history[e-1],o=new Map;for(const[e,{input:n}]of t.inputs.entries())o.set(e,n);t.state=n.state.tick(o)}}onRemoteInput(e,t,n){o.assert.isTrue(t.isRemotePlayer(),"'player' must be a remote player."),o.assert.isNotEmpty(this.history,"'history' cannot be empty."),e>this.history[this.history.length-1].frame&&i(this.future,t).push({frame:e,input:n});let s=0;for(let n=0;n<this.history.length;++n)if(this.history[n].isPlayerInputPredicted(t)){o.assert.equal(this.history[n].frame,e),s=n;break}for(let e=s;e<this.history.length;++e){let r=this.history[e],a=this.history[e-1],c=i(r.inputs,t),u=i(a.inputs,t);o.assert.isTrue(c.isPrediction),e===s?(c.isPrediction=!1,c.input=n):c.input=u.input.predictNext();let l=new Map;for(const[e,{input:t}]of r.inputs.entries())l.set(e,t);r.state=a.state.tick(l)}if(this.isServer)for(;this.history.length>=2;){let e=this.history[0],t=this.history[1];if(o.assert.isTrue(e.allInputsSynced()),!t.allInputsSynced())break;{let e=r(this.history);this.broadcastState(e.frame,e.state)}}}getState(){return this.history[this.history.length-1].state}currentFrame(){return o.assert.isNotEmpty(this.history,"'history' cannot be empty."),this.history[this.history.length-1].frame}largestFutureSize(){return Math.max(...Array.from(this.future.values()).map(e=>e.length))}tick(e){o.assert.isNotEmpty(this.history,"'history' cannot be empty.");const t=this.history[this.history.length-1],n=new Map;for(const[s,a]of t.inputs.entries())if(s.isLocalPlayer())n.set(s,{input:e,isPrediction:!1}),this.broadcastInput(t.frame+1,e);else if(i(this.future,s).length>0){let e=r(i(this.future,s));o.assert.equal(t.frame+1,e.frame),n.set(s,{input:e.input,isPrediction:!1})}else n.set(s,{input:a.input.predictNext(),isPrediction:!0});this.history.push(t.tick(n))}}const c=600,u=300,l=10,h=100,p=100,f=c-100-l,d=5,y=10,g=10;function b(e,t,n){return Math.min(Math.max(e,t),n)}function v(e,t,n,o,i,r,s,a){return e<r&&t>i&&n<a&&o>s}class m{tick(e){let t=this.leftPaddle,n=this.rightPaddle;for(const[o,i]of e.entries())0==o.getID()?t+=i.delta()*d:1==o.getID()&&(n+=i.delta()*d);t=b(t,0,u-h),n=b(n,0,u-h);let o=[this.ballPosition[0]+this.ballVelocity[0],this.ballPosition[1]+this.ballVelocity[1]],i=[this.ballVelocity[0],this.ballVelocity[1]];if(o[1]<0&&(o[1]=0,i[1]=-i[1]),o[1]>u-g&&(o[1]=u-g,i[1]=-i[1]),v(o[0],o[0]+y,o[1],o[1]+g,p,p+l,t,t+h)){let e=(o[1]+g/2-(t+h/2))/h;i[0]=-i[0],i[1]=5*Math.sin(2*e),o[0]=p+l}if(v(o[0],o[0]+y,o[1],o[1]+g,f,f+l,n,n+h)){let e=(o[1]+g/2-(n+h/2))/h;i[0]=-i[0],i[1]=5*Math.sin(2*e),o[0]=f-y}let r=this.leftScore,s=this.rightScore;return o[0]>c&&(r+=1,o=[c/2-y/2,u/2-g/2],i=[-5,0]),o[0]<-g&&(s+=1,o=[c/2-y/2,u/2-g/2],i=[5,0]),new m(t,n,o,i,r,s)}constructor(e,t,n,o,i,r){this.leftPaddle=e,this.rightPaddle=t,this.ballPosition=n,this.ballVelocity=o,this.leftScore=i,this.rightScore=r}toJSON(){return{leftPaddle:this.leftPaddle,rightPaddle:this.rightPaddle,ballPosition:this.ballPosition,ballVelocity:this.ballVelocity,leftScore:this.leftScore,rightScore:this.rightScore}}static fromJSON(e){return new m(e.leftPaddle,e.rightPaddle,e.ballPosition,e.ballVelocity,e.leftScore,e.rightScore)}draw(e,t){t.fillStyle="black",t.fillRect(0,0,e.width,e.height),t.fillStyle="white",t.fillRect(p,this.leftPaddle,l,h),t.fillStyle="white",t.fillRect(f,this.rightPaddle,l,h),t.fillStyle="white",t.fillRect(this.ballPosition[0],this.ballPosition[1],y,g),t.font="40px Arial",t.textAlign="center",t.fillText(this.leftScore.toString(),.3*c,.2*u),t.fillText(this.rightScore.toString(),.7*c,.2*u)}static getInitialState(){return new m(u/2-h/2,u/2-h/2,[c/2-y/2,u/2-g/2],[5,0],0,0)}}class w{constructor(e){this.direction=e}predictNext(){return new w(this.direction)}equals(e){return e instanceof w&&e.direction==this.direction}delta(){return"up"==this.direction?-1:"down"==this.direction?1:0}toJSON(){return this.direction}static fromJSON(e){return o.assert.isString(e),new w(e)}}var _=n(16),k=n(17);const x=new(n.n(k).a)({config:{iceServers:[{url:"stun:stun.l.google.com:19302"}]}}),S=_.parse(window.location.hash),O=!!S.room,M=document.createElement("canvas");M.width=c,M.height=u,document.body.appendChild(M);const P=M.getContext("2d"),C=document.createElement("div");document.body.appendChild(C);let E=m.getInitialState(),j=null,N=null;if(O){console.log("This is a client.");const e=x.connect(S.room,{reliable:!0});e.on("open",()=>{console.log("Server has connected."),N=[{getID:()=>0,isLocalPlayer:()=>!1,isRemotePlayer:()=>!0,isServer:()=>!0,isClient:()=>!1},{getID:()=>1,isLocalPlayer:()=>!0,isRemotePlayer:()=>!1,isServer:()=>!1,isClient:()=>!0}];let t=new Map;t.set(N[0],{input:new w("none"),isPrediction:!1}),t.set(N[1],{input:new w("none"),isPrediction:!1}),j=new a(!1,E,t,10,(t,n)=>{e.send({type:"input",frame:t,input:n.toJSON()})}),e.on("data",e=>{"input"===e.type&&j.onRemoteInput(e.frame,N[0],w.fromJSON(e.input)),"state"===e.type&&j.onStateSync(e.frame,m.fromJSON(e.state))}),requestAnimationFrame(D)})}else console.log("This is a server."),x.on("open",e=>{C.innerHTML=`<div>Join URL: ${window.location.href}#room=${e}<div>`}),x.on("connection",e=>{e.on("open",()=>{console.log("Client has connected."),N=[{getID:()=>0,isLocalPlayer:()=>!0,isRemotePlayer:()=>!1,isServer:()=>!0,isClient:()=>!1},{getID:()=>1,isLocalPlayer:()=>!1,isRemotePlayer:()=>!0,isServer:()=>!1,isClient:()=>!0}];let t=new Map;t.set(N[0],{input:new w("none"),isPrediction:!1}),t.set(N[1],{input:new w("none"),isPrediction:!1}),j=new a(!0,E,t,10,(t,n)=>{e.send({type:"input",frame:t,input:n.toJSON()})},(t,n)=>{e.send({type:"state",frame:t,state:n.toJSON()})}),e.on("data",e=>{"input"===e.type&&j.onRemoteInput(e.frame,N[1],w.fromJSON(e.input))}),requestAnimationFrame(D)})});const A=1e3/60,B={};document.addEventListener("keydown",e=>{B[e.keyCode]=!0},!1),document.addEventListener("keyup",e=>{B[e.keyCode]=!1},!1);let T=0;function D(e){e>T+A&&(T=e);let t=new w("none");B[38]&&(t=new w("up")),B[40]&&(t=new w("down")),j.tick(t),j.getState().draw(M,P),C.innerHTML=`\n  <div>Timestep: ${A}</div>\n  <div>History Size: ${j.history.length}</div>\n  <div>Frame Number: ${j.currentFrame()}</div>\n  <div>Largest Future Size: ${j.largestFutureSize()}</div>\n  `,requestAnimationFrame(D)}}]);